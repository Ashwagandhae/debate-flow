var Yt=Object.defineProperty;var Ye=Object.getOwnPropertySymbols;var Gt=Object.prototype.hasOwnProperty,Qt=Object.prototype.propertyIsEnumerable;var Ge=(l,e,n)=>e in l?Yt(l,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[e]=n,Qe=(l,e)=>{for(var n in e||(e={}))Gt.call(e,n)&&Ge(l,n,e[n]);if(Ye)for(var n of Ye(e))Qt.call(e,n)&&Ge(l,n,e[n]);return l};import{S as ee,i as te,s as x,e as M,a as y,b as D,c as Ze,l as W,n as fe,d as q,r as me,f as St,g as he,h as J,j as Zt,w as Ee,q as ye,k as $t,m as Q,o as U,p as ie,t as z,u as L,v as _e,x as Le,y as A,z as E,A as De,B as Z,C as O,D as V,E as B,F as re,G as ue,H as xt,I as He,J as de,K as Ve,L as $e,M as At,N as en,O as pe,P as Fe,Q as Se,R as Pt,T as Ie,U as Ke,V as Xe,W as We,X as Pe,Y as ke,Z as xe,_ as tn,$ as nn,a0 as et,a1 as ln,a2 as tt,a3 as Me}from"./vendor.46b7759a.js";const on=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))t(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const f of i.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&t(f)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function t(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}};on();function sn(l){let e,n,t,o;return{c(){e=M("textarea"),y(e,"spellcheck","false"),y(e,"placeholder",l[1]),y(e,"style",n=`--white-space:${l[2]};`),y(e,"class","svelte-1t3wlx8")},m(i,f){D(i,e,f),Ze(e,l[0]),l[12](e),t||(o=[W(e,"input",l[11]),W(e,"load",l[4]),W(e,"input",l[4]),W(e,"beforeinput",l[7]),W(e,"keydown",l[8]),W(e,"focus",l[9]),W(e,"blur",l[10])],t=!0)},p(i,[f]){f&2&&y(e,"placeholder",i[1]),f&4&&n!==(n=`--white-space:${i[2]};`)&&y(e,"style",n),f&1&&Ze(e,i[0])},i:fe,o:fe,d(i){i&&q(e),l[12](null),t=!1,me(o)}}}function rn(l,e,n){let{value:t}=e,{placeholder:o=""}=e,{nowrap:i=!1}=e,f,r;function s(){n(3,r.value=r.value.replace(/\r?\n|\r/g,""),r),n(3,r.style.height="0px",r),n(3,r.style.height=r.scrollHeight+"px",r)}St(function(){s()});const u=()=>{r.focus()};function a(p){he.call(this,l,p)}function c(p){he.call(this,l,p)}function _(p){he.call(this,l,p)}function h(p){he.call(this,l,p)}function F(){t=this.value,n(0,t)}function b(p){J[p?"unshift":"push"](()=>{r=p,n(3,r)})}return l.$$set=p=>{"value"in p&&n(0,t=p.value),"placeholder"in p&&n(1,o=p.placeholder),"nowrap"in p&&n(5,i=p.nowrap)},l.$$.update=()=>{l.$$.dirty&32&&(i?n(2,f="nowrap"):n(2,f="auto"))},[t,o,f,r,s,i,u,a,c,_,h,F,b]}class Mt extends ee{constructor(e){super();te(this,e,rn,sn,x,{value:0,placeholder:1,nowrap:5,focus:6})}get focus(){return this.$$.ctx[6]}}function un(l){let e,n=l[1].svg+"",t;return{c(){e=Zt("svg"),y(e,"style",t=`width:${l[0]};height:${l[0]};`),y(e,"viewBox","0 0 "+100+" "+100),y(e,"fill","none"),y(e,"stroke","var(--text)"),y(e,"class","svelte-2n1qug")},m(o,i){D(o,e,i),e.innerHTML=n},p(o,[i]){i&1&&t!==(t=`width:${o[0]};height:${o[0]};`)&&y(e,"style",t)},i:fe,o:fe,d(o){o&&q(e)}}}function fn(l,e,n){let{name:t}=e,{size:o="1rem"}=e,f=[{name:"arrowRight",svg:'<path d="M27 7L74 50L27 93" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>'},{name:"arrowLeft",svg:'<path d="M74 93L27 50L74 7" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>'},{name:"arrowUp",svg:'<path d="M7.5 73.5L50.5 26.5L93.5 73.5" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>'},{name:"arrowDown",svg:'<path d="M93.5 26.5L50.5 73.5L7.5 26.5" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>'},{name:"delete",svg:`<path d="M78.5685 22L22 78.5685" stroke-width="10" stroke-linecap="round"/>
<path d="M22 22L78.5685 78.5685" stroke-width="10" stroke-linecap="round"/>`},{name:"add",svg:`<path d="M50 15L50 85" stroke-width="10" stroke-linecap="round"/>
<path d="M15 50H85" stroke-width="10" stroke-linecap="round"/>`},{name:"download",svg:`<path d="M71 45L50 68L29 45" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M20 85L80 85" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M50 66L50 14" stroke-width="10" stroke-linecap="round"/>`},{name:"upload",svg:`<path d="M29 37L50 14L71 37" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M20 85L80 85" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M50 16L50 68" stroke-width="10" stroke-linecap="round"/>`},{name:"addUp",svg:`<path d="M85 25V25C87.7614 25 90 27.2386 90 30V70C90 75.5228 85.5228 80 80 80H20C14.4772 80 10 75.5228 10 70L10 30C10 27.2386 12.2386 25 15 25V25" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M35 25H65" stroke-width="10" stroke-linecap="round"/>
<path d="M50 40V10" stroke-width="10" stroke-linecap="round"/>`},{name:"addDown",svg:`<path d="M15 75V75C12.2386 75 10 72.7614 10 70L10 30C10 24.4772 14.4772 20 20 20L80 20C85.5228 20 90 24.4772 90 30L90 70C90 72.7614 87.7614 75 85 75V75" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M65 75H35" stroke-width="10" stroke-linecap="round"/>
<path d="M50 60L50 90" stroke-width="10" stroke-linecap="round"/>`},{name:"addRight",svg:`<path d="M75 85V85C75 87.7614 72.7614 90 70 90H30C24.4772 90 20 85.5228 20 80V20C20 14.4772 24.4772 10 30 10H70C72.7614 10 75 12.2386 75 15V15" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M75 35V65" stroke-width="10" stroke-linecap="round"/>
<path d="M60 50H90" stroke-width="10" stroke-linecap="round"/>`},{name:"undo",svg:`<path d="M10 47H70C81.0457 47 90 55.9543 90 67V77" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M36 70L10 47L36 24" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>`},{name:"redo",svg:`<path d="M90 47H30C18.9543 47 10 55.9543 10 67V77" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M64 70L90 47L64 24" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>`},{name:"settings",svg:`<line x1="10" y1="50" x2="90" y2="50" stroke-width="10" stroke-linecap="round"/>
<line x1="10" y1="80" x2="90" y2="80" stroke-width="10" stroke-linecap="round"/>
<line x1="10" y1="20" x2="90" y2="20" stroke-width="10" stroke-linecap="round"/>
<circle cx="26.25" cy="50.25" r="6.25" stroke-width="10"/>
<circle cx="71.25" cy="80.25" r="6.25" stroke-width="10"/>
<circle cx="71.25" cy="20.25" r="6.25" stroke-width="10"/>`}].find(r=>r.name===t);return l.$$set=r=>{"name"in r&&n(2,t=r.name),"size"in r&&n(0,o=r.size)},[o,f,t]}class Rt extends ee{constructor(e){super();te(this,e,fn,un,x,{name:2,size:0})}}const G=Ee([]);let we=Ee(0);const an=Ee({aff:{columns:["1AC","1NC","2AC","2NC/1NR","1AR","2NR","2AR"],invert:!1},neg:{columns:["1NC","2AC","2NC/1NR","1AR","2NR","2AR"],invert:!0}});let Be;G.subscribe(l=>{Be=l});let Ue;an.subscribe(l=>{Ue=l});function Ae(l,e,n){return{content:"",children:[],index:l,level:e,focus:n}}function cn(l,e){return{content:"",level:0,columns:Ue[e].columns,invert:Ue[e].invert,focus:!0,index:l,lastFocus:void 0,children:[Ae(0,1,!1)],history:new Bt}}function ae(l,e){e||(e=0);let n={children:Be};for(let t=0;t<l.length-e;t++)n=n.children[l[t]];return n}class Bt{constructor(){this.index=-1,this.data=[],this.lastFocus=void 0}lastAction(){return this.data[this.index]}add(e,n,t){this.resolveAllPending();let o={type:e,path:n,lastFocus:[...this.lastFocus],nextFocus:void 0};o.type=="delete"&&(o.box=Qe({},t.box)),this.data=this.data.slice(0,this.index+1),this.data.push(o),this.index=this.data.length-1}addPending(e,n,t){this.data=this.data.slice(0,this.index+1),this.data.push({type:e,pending:!0,path:n,other:t}),this.index=this.data.length-1}resolveAllPending(){let e=!1;for(let n=0;n<this.data.length;n++){let t=this.data[n];if(t.pending){let o={type:t.type,path:t.path,lastFocus:t.path,nextFocus:t.path},i=!0;o.type=="edit"&&(o.lastContent=t.other.lastContent,o.nextContent=t.other.getNextContent(),o.lastContent==o.nextContent&&(i=!1),t.other.createEditBreak()),i?(e=!0,this.data[n]=o):(this.data[n]=null,this.index>=n&&(this.index-=1))}}this.data=this.data.filter(n=>n!=null),e&&console.log("resolving all pending")}addFocus(e){this.lastFocus=e,this.lastAction()&&this.lastAction().nextFocus==null&&(this.lastAction().nextFocus=e)}undoAction(e){console.log("undo",this.index,this.data);let n=ae(e.path,1),t=e.path[e.path.length-1],o=[...n.children];e.type=="add"?o.splice(t,1):e.type=="delete"?o.splice(t,0,e.box):e.type=="edit"&&(o[t].content=e.lastContent);for(let i=t;i<o.length;i++)o[i].index=i;n.children=[...o]}redoAction(e){console.log("redo",this.index,this.data);let n=ae(e.path,1),t=e.path[e.path.length-1],o=[...n.children];e.type=="add"?o.splice(t,0,Ae(t,n.level+1,!1)):e.type=="delete"?o.splice(t,1):e.type=="edit"&&(o[t].content=e.nextContent);for(let i=t;i<o.length;i++)o[i].index=i;n.children=[...o]}focus(e){let n=ae(e);n.focus=!0}undo(){if(this.resolveAllPending(),this.index>-1){let e=this.lastAction();this.undoAction(e),this.focus(e.lastFocus),G.set(Be),this.index-=1}}redo(){if(this.resolveAllPending(),this.index<this.data.length-1){this.index+=1;let e=this.lastAction();this.redoAction(e),this.focus(e.nextFocus),G.set(Be)}}}const ce=300;function dn(l,{duration:e=ce}){const n=l.clientHeight;return{duration:e,css:t=>{const o=ye(t);return`
        height: ${o*n}px;
        overflow: visible;
        clip-path: inset(${(1-o)*n-2}px 0 -${n}px 0);
        transform: translateY(${(1-o)*-n}px);
        `}}}function hn(l,{duration:e=ce}){const n=l.clientHeight;return{duration:e,css:t=>{const o=ye(t);return`
        height: ${o*n}px;
        overflow: visible;
        clip-path: inset(${(1-o)*n}px 0 0 0);
        transform: translateY(${(1-o)*-n}px);
        `}}}function _n(l,{delay:e=0,duration:n=ce}){return{delay:e,duration:n,css:t=>`
        opacity:${t};
      `}}function nt(l,{delay:e=0,duration:n=ce}){return{delay:e,duration:n,css:t=>{const o=ye(t);return`
        clip-path:inset(0% ${(1-o)*100}% 0% 0%);
        transform: translateX(${(1-o)*50}%);
      `}}}function lt(l,{delay:e=0,duration:n=ce}){return{delay:e,duration:n,css:t=>{const o=$t(t);return`
      clip-path:inset(0% ${(1-o)*100}% 0% 0%);
      transform: translateX(${(1-o)*50}%)`}}}function pn(l,{duration:e=ce}){const n=l.clientHeight;return{duration:e,css:t=>{const o=ye(t);return`
        height: ${n*o}px;
        overflow: hidden;
        transform: translateX(${-100*(1-o)}%);
      `}}}function ot(l,{delay:e=0,duration:n=ce}){return{delay:e,duration:n,css:t=>`
        transform: scale(${ye(t)});
        opacity: ${t};
      `}}function it(l,{delay:e=0,duration:n=ce}){return{delay:e,duration:n,css:t=>`
        transform: scale(${ye(t)});
        opacity: ${t};
      `}}function st(l,e,n){const t=l.slice();return t[53]=e[n],t[54]=e,t[55]=n,t}function rt(l){let e,n,t,o,i,f,r;return n=new Rt({props:{name:"add"}}),{c(){e=M("button"),U(n.$$.fragment),y(e,"class",t=ie(`add palette-${l[13]}`)+" svelte-172kgc0")},m(s,u){D(s,e,u),z(n,e,null),i=!0,f||(r=[W(e,"click",l[33]),W(e,"mousedown",ze)],f=!0)},p(s,u){(!i||u[0]&8192&&t!==(t=ie(`add palette-${s[13]}`)+" svelte-172kgc0"))&&y(e,"class",t)},i(s){i||(L(n.$$.fragment,s),s&&(o||_e(()=>{o=Le(e,_n,{}),o.start()})),i=!0)},o(s){A(n.$$.fragment,s),i=!1},d(s){s&&q(e),E(n),f=!1,me(r)}}}function ut(l,e){let n,t,o,i,f,r,s,u;function a(p){e[34](p,e[53])}function c(p){e[35](p,e[53])}function _(p){e[36](p,e[53])}function h(p){e[37](p,e[53])}function F(p){e[38](p,e[53])}let b={addSibling:e[21],deleteSelf:e[22],focusSibling:e[23],focusParent:e[24],dispatchSelfFocus:e[16],parentPath:e[8]};return e[53].content!==void 0&&(b.content=e[53].content),e[53].children!==void 0&&(b.children=e[53].children),e[53].index!==void 0&&(b.index=e[53].index),e[53].level!==void 0&&(b.level=e[53].level),e[53].focus!==void 0&&(b.focus=e[53].focus),t=new Dt({props:b}),J.push(()=>Q(t,"content",a)),J.push(()=>Q(t,"children",c)),J.push(()=>Q(t,"index",_)),J.push(()=>Q(t,"level",h)),J.push(()=>Q(t,"focus",F)),t.$on("saveFocus",e[39]),{key:l,first:null,c(){n=De(),U(t.$$.fragment),this.first=n},m(p,C){D(p,n,C),z(t,p,C),u=!0},p(p,C){e=p;const R={};C[0]&256&&(R.parentPath=e[8]),!o&&C[0]&4&&(o=!0,R.content=e[53].content,Z(()=>o=!1)),!i&&C[0]&4&&(i=!0,R.children=e[53].children,Z(()=>i=!1)),!f&&C[0]&4&&(f=!0,R.index=e[53].index,Z(()=>f=!1)),!r&&C[0]&4&&(r=!0,R.level=e[53].level,Z(()=>r=!1)),!s&&C[0]&4&&(s=!0,R.focus=e[53].focus,Z(()=>s=!1)),t.$set(R)},i(p){u||(L(t.$$.fragment,p),u=!0)},o(p){A(t.$$.fragment,p),u=!1},d(p){p&&q(n),E(t,p)}}}function gn(l){let e,n,t,o,i,f,r,s,u,a,c,_,h,F,b,p,C=[],R=new Map,K,P,T,I,m,se;function H(g){l[30](g)}let v={placeholder:l[11]};l[1]!==void 0&&(v.value=l[1]),s=new Mt({props:v}),J.push(()=>Q(s,"value",H)),l[31](s),s.$on("keydown",l[19]),s.$on("beforeinput",l[20]),s.$on("blur",l[18]),s.$on("focus",l[17]);let d=l[2].length==0&&l[5]<l[14]&&rt(l),S=l[2];const N=g=>g[53];for(let g=0;g<S.length;g+=1){let j=st(l,S,g),oe=N(j);R.set(oe,C[g]=ut(oe,j))}return{c(){e=M("div"),n=M("div"),t=M("div"),o=M("div"),r=O(),U(s.$$.fragment),a=O(),c=M("div"),F=O(),d&&d.c(),b=O(),p=M("ul");for(let g=0;g<C.length;g+=1)C[g].c();y(o,"class","line above svelte-172kgc0"),V(o,"left",l[2].length>0),V(o,"right",l[4]==0&&l[5]>1),y(c,"class","line below svelte-172kgc0"),y(t,"class","barcontainer svelte-172kgc0"),y(n,"class","content svelte-172kgc0"),y(n,"style",`--this-background: ${l[15]}`),V(n,"root",l[3]),V(n,"left",l[2].length>0),V(n,"right",l[4]==0&&l[5]>1),y(p,"class","children svelte-172kgc0"),y(e,"class",K=ie(`top palette-${l[12]}`)+" svelte-172kgc0"),V(e,"empty",l[2].length==0),V(e,"focus",l[0]),V(e,"childFocus",l[10]),V(e,"highlight",l[10]||l[0])},m(g,j){D(g,e,j),B(e,n),B(n,t),B(t,o),B(t,r),z(s,t,null),B(t,a),B(t,c),B(n,F),d&&d.m(n,null),B(e,b),B(e,p);for(let oe=0;oe<C.length;oe+=1)C[oe].m(p,null);I=!0,m||(se=[W(o,"click",l[29]),W(o,"mousedown",ze),W(c,"click",l[32]),W(c,"mousedown",ze)],m=!0)},p(g,j){j[0]&4&&V(o,"left",g[2].length>0),j[0]&48&&V(o,"right",g[4]==0&&g[5]>1);const oe={};j[0]&2048&&(oe.placeholder=g[11]),!u&&j[0]&2&&(u=!0,oe.value=g[1],Z(()=>u=!1)),s.$set(oe),g[2].length==0&&g[5]<g[14]?d?(d.p(g,j),j[0]&36&&L(d,1)):(d=rt(g),d.c(),L(d,1),d.m(n,null)):d&&(re(),A(d,1,1,()=>{d=null}),ue()),j[0]&8&&V(n,"root",g[3]),j[0]&4&&V(n,"left",g[2].length>0),j[0]&48&&V(n,"right",g[4]==0&&g[5]>1),j[0]&31523076&&(S=g[2],re(),C=xt(C,j,N,1,g,S,R,p,en,ut,null,st),ue()),(!I||j[0]&4096&&K!==(K=ie(`top palette-${g[12]}`)+" svelte-172kgc0"))&&y(e,"class",K),j[0]&4100&&V(e,"empty",g[2].length==0),j[0]&4097&&V(e,"focus",g[0]),j[0]&5120&&V(e,"childFocus",g[10]),j[0]&5121&&V(e,"highlight",g[10]||g[0])},i(g){if(!I){g&&_e(()=>{f&&f.end(1),i=Le(o,nt,{}),i.start()}),L(s.$$.fragment,g),g&&_e(()=>{h&&h.end(1),_=Le(c,nt,{}),_.start()}),L(d);for(let j=0;j<S.length;j+=1)L(C[j]);g&&_e(()=>{T&&T.end(1),P=Le(e,dn,{}),P.start()}),I=!0}},o(g){i&&i.invalidate(),g&&(f=He(o,lt,{})),A(s.$$.fragment,g),_&&_.invalidate(),g&&(h=He(c,lt,{})),A(d);for(let j=0;j<C.length;j+=1)A(C[j]);P&&P.invalidate(),g&&(T=He(e,hn,{})),I=!1},d(g){g&&q(e),g&&f&&f.end(),l[31](null),E(s),g&&h&&h.end(),d&&d.d();for(let j=0;j<C.length;j+=1)C[j].d();g&&T&&T.end(),m=!1,me(se)}}}function ze(l){l.preventDefault()}function mn(l,e,n){let t,o,i;de(l,we,k=>n(42,o=k)),de(l,G,k=>n(43,i=k));const f=Ve();let{root:r=!1}=e,{content:s}=e,{children:u}=e,{index:a}=e,{level:c}=e,{focus:_}=e,{parentPath:h=[]}=e,{addSibling:F=()=>{}}=e,{deleteSelf:b=()=>{}}=e,{focusSibling:p=()=>{}}=e,{focusParent:C=()=>{}}=e,{dispatchSelfFocus:R=()=>{}}=e;const{getinvert:K}=$e("invert");let P=K();const{getColumnCount:T}=$e("columnCount");let I=T(),m,se,H=!1,v=-1;function d(k,X){X?(n(10,H=!0),v=k):k==v&&(n(10,H=!1),v=-1)}let S=!1;function N(){_?(R(a,!0),c>=1&&(i[o].history.addFocus([...t]),f("saveFocus",t),m&&m.focus())):(R(a,!1),S=!1)}At(N);function g(){_&&(R(a,!0),i[o].history.addFocus([...t]))}let j="";function oe(){_||Ce()}function w(){_&&n(0,_=!1)}class Y{constructor(X,ne=()=>!0,be=!0,ve=!0,Jt=!0){this.require=ne,this.stopRepeat=be,this.preventDefault=ve,this.blur=Jt,this.handle=function(Je){return!this.require()||(this.preventDefault&&Je.preventDefault(),this.stopRepeat&&Je.repeat==!0)?!1:(this.blur&&n(0,_=!1),X(),!0)}}}const $={shift:{Enter:new Y(()=>{Ne(0,0)&&ge(0,0)})},other:{Enter:new Y(()=>{F(a,1)&&p(a,1)}),Backspace:new Y(()=>{b(a)},()=>s.length==0),ArrowUp:new Y(()=>p(a,-1)),ArrowDown:new Y(()=>p(a,1)),ArrowLeft:new Y(()=>C()),ArrowRight:new Y(()=>{u.length>0?ge(0,0):p(a,1)})}};function qe(k){k.shiftKey&&$.shift[k.key]?$.shift[k.key].handle(k):$.other[k.key]&&$.other[k.key].handle(k)}function Nt(k){S||(console.log("created pneding",t),i[o].history.addPending("edit",[...t],{lastContent:s,getNextContent(){return s},createEditBreak(){S=!1}})),S=!0}function Ne(k,X){let ne=k+X;if(c<I){let be=[...u];be.splice(ne,0,Ae(ne,c+1,!0));for(let ve=ne;ve<be.length;ve++)be[ve].index=ve;return i[o].history.add("add",[...t,ne]),n(2,u=[...be]),!0}else return Ce(),!1}function jt(k){if(u.length>1||c>=1){let X=[...u];i[o].history.add("delete",[...t,k],{box:X[k]}),X[k].focus=!1,X.splice(k,1);for(let ne=0;ne<X.length;ne++)X[ne].index=ne;return n(2,u=[...X]),u[k-1]?ge(k-1,0):u.length==0?Ce():k==0&&ge(0,0),!0}else return ge(0,0),!1}function ge(k,X){let ne=k+X;if(ne<0){Ce();return}ne>=u.length?u[u.length-1].children.length>0?n(2,u[u.length-1].children[0].focus=!0,u):n(2,u[k].focus=!0,u):n(2,u[ne].focus=!0,u),n(2,u)}function Ce(){n(0,_=!0)}let je,Te;const Tt=()=>{F(a,0)&&p(a,0)};function Ht(k){s=k,n(1,s)}function Ot(k){J[k?"unshift":"push"](()=>{m=k,n(9,m)})}const Ut=()=>{F(a,1)&&p(a,1)},zt=()=>{Ne(0,0),ge(0,0)};function Et(k,X){l.$$.not_equal(X.content,k)&&(X.content=k,n(2,u))}function Vt(k,X){l.$$.not_equal(X.children,k)&&(X.children=k,n(2,u))}function It(k,X){l.$$.not_equal(X.index,k)&&(X.index=k,n(2,u))}function Kt(k,X){l.$$.not_equal(X.level,k)&&(X.level=k,n(2,u))}function Xt(k,X){l.$$.not_equal(X.focus,k)&&(X.focus=k,n(2,u))}function Wt(k){he.call(this,l,k)}return l.$$set=k=>{"root"in k&&n(3,r=k.root),"content"in k&&n(1,s=k.content),"children"in k&&n(2,u=k.children),"index"in k&&n(4,a=k.index),"level"in k&&n(5,c=k.level),"focus"in k&&n(0,_=k.focus),"parentPath"in k&&n(25,h=k.parentPath),"addSibling"in k&&n(6,F=k.addSibling),"deleteSelf"in k&&n(26,b=k.deleteSelf),"focusSibling"in k&&n(7,p=k.focusSibling),"focusParent"in k&&n(27,C=k.focusParent),"dispatchSelfFocus"in k&&n(28,R=k.dispatchSelfFocus)},l.$$.update=()=>{l.$$.dirty[0]&33554448&&n(8,t=[...h,a]),l.$$.dirty[0]&1&&N(),l.$$.dirty[0]&256&&g(),l.$$.dirty[0]&48&&(c==1&&a==0?n(11,j="type here"):n(11,j="")),l.$$.dirty[0]&32&&(c%2==0&&!P||c%2==1&&P?n(12,je="accent-secondary"):n(12,je="accent")),l.$$.dirty[0]&32&&(c%2==0&&!P||c%2==1&&P?n(13,Te="accent"):n(13,Te="accent-secondary"))},[_,s,u,r,a,c,F,p,t,m,H,j,je,Te,I,se,d,oe,w,qe,Nt,Ne,jt,ge,Ce,h,b,C,R,Tt,Ht,Ot,Ut,zt,Et,Vt,It,Kt,Xt,Wt]}class Dt extends ee{constructor(e){super();te(this,e,mn,gn,x,{root:3,content:1,children:2,index:4,level:5,focus:0,parentPath:25,addSibling:6,deleteSelf:26,focusSibling:7,focusParent:27,dispatchSelfFocus:28},null,[-1,-1])}}function ft(l,e,n){const t=l.slice();return t[1]=e[n],t[3]=n,t}function bn(l){let e;return{c(){e=pe("+")},m(n,t){D(n,e,t)},d(n){n&&q(e)}}}function at(l){let e,n,t=l[1]+"",o,i=l[3]!=0&&bn();return{c(){i&&i.c(),e=O(),n=M("kbd"),o=pe(t),y(n,"class","key svelte-eb7adw")},m(f,r){i&&i.m(f,r),D(f,e,r),D(f,n,r),B(n,o)},p(f,r){r&1&&t!==(t=f[1]+"")&&Fe(o,t)},d(f){i&&i.d(f),f&&q(e),f&&q(n)}}}function vn(l){let e,n=l[0],t=[];for(let o=0;o<n.length;o+=1)t[o]=at(ft(l,n,o));return{c(){e=M("span");for(let o=0;o<t.length;o+=1)t[o].c();y(e,"class","top svelte-eb7adw")},m(o,i){D(o,e,i);for(let f=0;f<t.length;f+=1)t[f].m(e,null)},p(o,[i]){if(i&1){n=o[0];let f;for(f=0;f<n.length;f+=1){const r=ft(o,n,f);t[f]?t[f].p(r,i):(t[f]=at(r),t[f].c(),t[f].m(e,null))}for(;f<t.length;f+=1)t[f].d(1);t.length=n.length}},i:fe,o:fe,d(o){o&&q(e),Se(t,o)}}}function wn(l,e,n){let{keys:t}=e;return l.$$set=o=>{"keys"in o&&n(0,t=o.keys)},[t]}class kn extends ee{constructor(e){super();te(this,e,wn,vn,x,{keys:0})}}function yn(l){let e;const n=l[13].default,t=Ie(n,l,l[12],null);return{c(){t&&t.c()},m(o,i){t&&t.m(o,i),e=!0},p(o,i){t&&t.p&&(!e||i&4096)&&Ke(t,n,o,o[12],e?We(n,o[12],i,null):Xe(o[12]),null)},i(o){e||(L(t,o),e=!0)},o(o){A(t,o),e=!1},d(o){t&&t.d(o)}}}function Fn(l){let e,n,t,o,i,f;const r=l[13].default,s=Ie(r,l,l[12],null);let u=l[3]&&ct(l);return{c(){e=M("div"),s&&s.c(),n=O(),u&&u.c(),t=De(),y(e,"class","element svelte-1p8z6bu")},m(a,c){D(a,e,c),s&&s.m(e,null),l[14](e),D(a,n,c),u&&u.m(a,c),D(a,t,c),o=!0,i||(f=[W(e,"mouseover",l[8]),W(e,"focus",l[8]),W(e,"mouseleave",l[10]),W(e,"blur",l[10]),W(e,"mousemove",l[9])],i=!0)},p(a,c){s&&s.p&&(!o||c&4096)&&Ke(s,r,a,a[12],o?We(r,a[12],c,null):Xe(a[12]),null),a[3]?u?(u.p(a,c),c&8&&L(u,1)):(u=ct(a),u.c(),L(u,1),u.m(t.parentNode,t)):u&&(re(),A(u,1,1,()=>{u=null}),ue())},i(a){o||(L(s,a),L(u),o=!0)},o(a){A(s,a),A(u),o=!1},d(a){a&&q(e),s&&s.d(a),l[14](null),a&&q(n),u&&u.d(a),a&&q(t),i=!1,me(f)}}}function ct(l){let e,n,t,o,i,f,r,s=!l[2]&&l[1]&&dt(l),u=l[2]&&ht(l);return{c(){e=M("div"),n=M("div"),t=pe(l[0]),o=O(),s&&s.c(),i=O(),u&&u.c(),y(n,"class","content"),Pe(e,"top",l[5]+"px"),Pe(e,"left",l[4]+"px"),y(e,"class","tooltip svelte-1p8z6bu")},m(a,c){D(a,e,c),B(e,n),B(n,t),B(e,o),s&&s.m(e,null),B(e,i),u&&u.m(e,null),l[15](e),r=!0},p(a,c){(!r||c&1)&&Fe(t,a[0]),!a[2]&&a[1]?s?(s.p(a,c),c&6&&L(s,1)):(s=dt(a),s.c(),L(s,1),s.m(e,i)):s&&(re(),A(s,1,1,()=>{s=null}),ue()),a[2]?u?u.p(a,c):(u=ht(a),u.c(),u.m(e,null)):u&&(u.d(1),u=null),(!r||c&32)&&Pe(e,"top",a[5]+"px"),(!r||c&16)&&Pe(e,"left",a[4]+"px")},i(a){r||(L(s),_e(()=>{f||(f=ke(e,ot,{},!0)),f.run(1)}),r=!0)},o(a){A(s),f||(f=ke(e,ot,{},!1)),f.run(0),r=!1},d(a){a&&q(e),s&&s.d(),u&&u.d(),l[15](null),a&&f&&f.end()}}}function dt(l){let e,n;return e=new kn({props:{keys:l[1]}}),{c(){U(e.$$.fragment)},m(t,o){z(e,t,o),n=!0},p(t,o){const i={};o&2&&(i.keys=t[1]),e.$set(i)},i(t){n||(L(e.$$.fragment,t),n=!0)},o(t){A(e.$$.fragment,t),n=!1},d(t){E(e,t)}}}function ht(l){let e,n;return{c(){e=M("div"),n=pe(l[2]),y(e,"class","disabled svelte-1p8z6bu")},m(t,o){D(t,e,o),B(e,n)},p(t,o){o&4&&Fe(n,t[2])},d(t){t&&q(e)}}}function Cn(l){let e,n,t,o;const i=[Fn,yn],f=[];function r(s,u){return s[0]?0:1}return e=r(l),n=f[e]=i[e](l),{c(){n.c(),t=De()},m(s,u){f[e].m(s,u),D(s,t,u),o=!0},p(s,[u]){let a=e;e=r(s),e===a?f[e].p(s,u):(re(),A(f[a],1,1,()=>{f[a]=null}),ue(),n=f[e],n?n.p(s,u):(n=f[e]=i[e](s),n.c()),L(n,1),n.m(t.parentNode,t))},i(s){o||(L(n),o=!0)},o(s){A(n),o=!1},d(s){f[e].d(s),s&&q(t)}}}function Ln(l,e,n){let{$$slots:t={},$$scope:o}=e,{content:i}=e,{shortcut:f}=e,{disabled:r=!1}=e,{layout:s="bottom"}=e,u=!1,a,c,_,h;function F(P){n(3,u=!0),b()}function b(){if(h){let P=_.getBoundingClientRect();n(4,a=P.left-h.offsetWidth/2+P.width/2),a<4?n(4,a=4):a+h.offsetWidth>window.innerWidth-4&&n(4,a=window.innerWidth-h.offsetWidth-4),s=="bottom"?n(5,c=P.bottom+4):n(5,c=P.top-h.offsetHeight-4)}}async function p(){await Pt(),b()}function C(){n(3,u=!1)}function R(P){J[P?"unshift":"push"](()=>{_=P,n(6,_)})}function K(P){J[P?"unshift":"push"](()=>{h=P,n(7,h)})}return l.$$set=P=>{"content"in P&&n(0,i=P.content),"shortcut"in P&&n(1,f=P.shortcut),"disabled"in P&&n(2,r=P.disabled),"layout"in P&&n(11,s=P.layout),"$$scope"in P&&n(12,o=P.$$scope)},l.$$.update=()=>{l.$$.dirty&2055&&p()},[i,f,r,u,a,c,_,h,F,b,C,s,o,t,R,K]}class Sn extends ee{constructor(e){super();te(this,e,Ln,Cn,x,{content:0,shortcut:1,disabled:2,layout:11})}}function An(l){let e,n;return{c(){e=M("div"),n=pe(l[0]),y(e,"class","top svelte-10zixka")},m(t,o){D(t,e,o),B(e,n)},p(t,[o]){o&1&&Fe(n,t[0])},i:fe,o:fe,d(t){t&&q(e)}}}function Pn(l,e,n){Ve();let{column:t}=e;return l.$$set=o=>{"column"in o&&n(0,t=o.column)},[t]}class Mn extends ee{constructor(e){super();te(this,e,Pn,An,x,{column:0})}}function _t(l,e,n){const t=l.slice();return t[8]=e[n],t[10]=n,t}function pt(l,e,n){const t=l.slice();return t[11]=e[n],t[10]=n,t}function gt(l){let e,n,t,o,i;return n=new Mn({props:{column:l[11]}}),n.$on("focusFlow",l[7]),{c(){e=M("h1"),U(n.$$.fragment),t=O(),y(e,"class",o=ie(`header palette-${l[10]%2==l[0].invert?"accent":"accent-secondary"}`)+" svelte-150s666")},m(f,r){D(f,e,r),z(n,e,null),B(e,t),i=!0},p(f,r){const s={};r&1&&(s.column=f[11]),n.$set(s),(!i||r&1&&o!==(o=ie(`header palette-${f[10]%2==f[0].invert?"accent":"accent-secondary"}`)+" svelte-150s666"))&&y(e,"class",o)},i(f){i||(L(n.$$.fragment,f),i=!0)},o(f){A(n.$$.fragment,f),i=!1},d(f){f&&q(e),E(n)}}}function mt(l){let e,n;return{c(){e=M("div"),y(e,"class",n=ie(`column palette-${l[10]%2==l[0].invert?"plain":"plain-secondary"}`)+" svelte-150s666")},m(t,o){D(t,e,o)},p(t,o){o&1&&n!==(n=ie(`column palette-${t[10]%2==t[0].invert?"plain":"plain-secondary"}`)+" svelte-150s666")&&y(e,"class",n)},d(t){t&&q(e)}}}function Rn(l){let e,n,t,o,i,f,r,s,u,a,c,_,h,F,b;function p(d){l[2](d)}function C(d){l[3](d)}function R(d){l[4](d)}function K(d){l[5](d)}function P(d){l[6](d)}let T={root:!0};l[0].content!==void 0&&(T.content=l[0].content),l[0].children!==void 0&&(T.children=l[0].children),l[0].index!==void 0&&(T.index=l[0].index),l[0].level!==void 0&&(T.level=l[0].level),l[0].focus!==void 0&&(T.focus=l[0].focus),o=new Dt({props:T}),J.push(()=>Q(o,"content",p)),J.push(()=>Q(o,"children",C)),J.push(()=>Q(o,"index",R)),J.push(()=>Q(o,"level",K)),J.push(()=>Q(o,"focus",P)),o.$on("saveFocus",l[1]);let I=l[0].columns,m=[];for(let d=0;d<I.length;d+=1)m[d]=gt(pt(l,I,d));const se=d=>A(m[d],1,1,()=>{m[d]=null});let H=l[0].columns,v=[];for(let d=0;d<H.length;d+=1)v[d]=mt(_t(l,H,d));return{c(){e=M("div"),n=M("div"),t=M("div"),U(o.$$.fragment),a=O(),c=M("div");for(let d=0;d<m.length;d+=1)m[d].c();_=O(),h=M("div");for(let d=0;d<v.length;d+=1)v[d].c();y(t,"class","content svelte-150s666"),y(c,"class","headers svelte-150s666"),y(h,"class","columns svelte-150s666"),y(n,"class","viewer svelte-150s666"),y(e,"class","top svelte-150s666"),y(e,"style",F=`--column-count: ${l[0].columns.length};`),V(e,"invert",l[0].invert)},m(d,S){D(d,e,S),B(e,n),B(n,t),z(o,t,null),B(n,a),B(n,c);for(let N=0;N<m.length;N+=1)m[N].m(c,null);B(n,_),B(n,h);for(let N=0;N<v.length;N+=1)v[N].m(h,null);b=!0},p(d,[S]){const N={};if(!i&&S&1&&(i=!0,N.content=d[0].content,Z(()=>i=!1)),!f&&S&1&&(f=!0,N.children=d[0].children,Z(()=>f=!1)),!r&&S&1&&(r=!0,N.index=d[0].index,Z(()=>r=!1)),!s&&S&1&&(s=!0,N.level=d[0].level,Z(()=>s=!1)),!u&&S&1&&(u=!0,N.focus=d[0].focus,Z(()=>u=!1)),o.$set(N),S&1){I=d[0].columns;let g;for(g=0;g<I.length;g+=1){const j=pt(d,I,g);m[g]?(m[g].p(j,S),L(m[g],1)):(m[g]=gt(j),m[g].c(),L(m[g],1),m[g].m(c,null))}for(re(),g=I.length;g<m.length;g+=1)se(g);ue()}if(S&1){H=d[0].columns;let g;for(g=0;g<H.length;g+=1){const j=_t(d,H,g);v[g]?v[g].p(j,S):(v[g]=mt(j),v[g].c(),v[g].m(h,null))}for(;g<v.length;g+=1)v[g].d(1);v.length=H.length}(!b||S&1&&F!==(F=`--column-count: ${d[0].columns.length};`))&&y(e,"style",F),S&1&&V(e,"invert",d[0].invert)},i(d){if(!b){L(o.$$.fragment,d);for(let S=0;S<I.length;S+=1)L(m[S]);b=!0}},o(d){A(o.$$.fragment,d),m=m.filter(Boolean);for(let S=0;S<m.length;S+=1)A(m[S]);b=!1},d(d){d&&q(e),E(o),Se(m,d),Se(v,d)}}}function Bn(l,e,n){let{root:t}=e;xe("invert",{getinvert:()=>t.invert}),xe("columnCount",{getColumnCount:()=>t.columns.length});function o(c){n(0,t.lastFocus=c.detail,t),n(0,t)}function i(c){l.$$.not_equal(t.content,c)&&(t.content=c,n(0,t))}function f(c){l.$$.not_equal(t.children,c)&&(t.children=c,n(0,t))}function r(c){l.$$.not_equal(t.index,c)&&(t.index=c,n(0,t))}function s(c){l.$$.not_equal(t.level,c)&&(t.level=c,n(0,t))}function u(c){l.$$.not_equal(t.focus,c)&&(t.focus=c,n(0,t))}function a(c){he.call(this,l,c)}return l.$$set=c=>{"root"in c&&n(0,t=c.root)},[t,o,i,f,r,s,u,a]}class Dn extends ee{constructor(e){super();te(this,e,Bn,Rn,x,{root:0})}}function qn(l){let e,n,t,o,i,f;function r(u){l[12](u)}let s={nowrap:!0,placeholder:"type name here"};return l[1]!==void 0&&(s.value=l[1]),t=new Mt({props:s}),J.push(()=>Q(t,"value",r)),l[13](t),t.$on("blur",l[5]),t.$on("focus",l[6]),t.$on("keydown",l[7]),t.$on("beforeinput",l[8]),{c(){e=M("div"),n=M("div"),U(t.$$.fragment),y(n,"class","content svelte-gvyz0w"),V(n,"focus",l[0]),y(e,"class",i=ie(`top palette-${l[4]}`)+" svelte-gvyz0w"),V(e,"invert",l[2])},m(u,a){D(u,e,a),B(e,n),z(t,n,null),f=!0},p(u,[a]){const c={};!o&&a&2&&(o=!0,c.value=u[1],Z(()=>o=!1)),t.$set(c),a&1&&V(n,"focus",u[0]),(!f||a&16&&i!==(i=ie(`top palette-${u[4]}`)+" svelte-gvyz0w"))&&y(e,"class",i),a&20&&V(e,"invert",u[2])},i(u){f||(L(t.$$.fragment,u),f=!0)},o(u){A(t.$$.fragment,u),f=!1},d(u){u&&q(e),l[13](null),E(t)}}}function Nn(l,e,n){let t,o,i;de(l,we,m=>n(17,o=m)),de(l,G,m=>n(18,i=m));const f=Ve();let{content:r}=e,{children:s}=e,{index:u}=e,{level:a}=e,{focus:c}=e,{invert:_}=e,h;function F(){c&&n(0,c=!1)}function b(){c||n(0,c=!0)}function p(m){(m.key=="Enter"||m.key=="ArrowDown")&&(m.preventDefault(),s.length>0&&(n(9,s[0].focus=!0,s),n(0,c=!1)))}let C=!1;function R(){c?(i[o].history.addFocus([...t]),f("saveFocus",t),h&&h.focus()):C=!1}At(R);function K(m){C||(console.log("created pneding",t),i[o].history.addPending("edit",[...t],{lastContent:r,getNextContent(){return r},createEditBreak(){C=!1}})),C=!0}let P="plain";function T(m){r=m,n(1,r)}function I(m){J[m?"unshift":"push"](()=>{h=m,n(3,h)})}return l.$$set=m=>{"content"in m&&n(1,r=m.content),"children"in m&&n(9,s=m.children),"index"in m&&n(10,u=m.index),"level"in m&&n(11,a=m.level),"focus"in m&&n(0,c=m.focus),"invert"in m&&n(2,_=m.invert)},l.$$.update=()=>{l.$$.dirty&1024&&(t=[u]),l.$$.dirty&1,l.$$.dirty&1&&R(),l.$$.dirty&4&&(_?n(4,P="accent-secondary"):n(4,P="accent"))},[c,r,_,h,P,F,b,p,K,s,u,a,T,I]}class jn extends ee{constructor(e){super();te(this,e,Nn,qn,x,{content:1,children:9,index:10,level:11,focus:0,invert:2})}}function bt(l){let e,n;return{c(){e=M("p"),n=pe(l[1]),y(e,"class","svelte-rfejcw")},m(t,o){D(t,e,o),B(e,n)},p(t,o){o&2&&Fe(n,t[1])},d(t){t&&q(e)}}}function Tn(l){let e,n,t,o,i,f,r;n=new Rt({props:{name:l[0],size:"var(--button-size)"}});let s=l[1]&&bt(l);return{c(){e=M("button"),U(n.$$.fragment),t=O(),s&&s.c(),y(e,"class",o=ie(`top palette-${l[3]?"disabled":l[4]}`)+" svelte-rfejcw"),e.disabled=l[3],V(e,"disabled",l[3])},m(u,a){D(u,e,a),z(n,e,null),B(e,t),s&&s.m(e,null),i=!0,f||(r=[W(e,"click",l[8]),W(e,"mousedown",On)],f=!0)},p(u,a){const c={};a&1&&(c.name=u[0]),n.$set(c),u[1]?s?s.p(u,a):(s=bt(u),s.c(),s.m(e,null)):s&&(s.d(1),s=null),(!i||a&24&&o!==(o=ie(`top palette-${u[3]?"disabled":u[4]}`)+" svelte-rfejcw"))&&y(e,"class",o),(!i||a&8)&&(e.disabled=u[3]),a&24&&V(e,"disabled",u[3])},i(u){i||(L(n.$$.fragment,u),i=!0)},o(u){A(n.$$.fragment,u),i=!1},d(u){u&&q(e),E(n),s&&s.d(),f=!1,me(r)}}}function Hn(l){let e,n;return e=new Sn({props:{content:l[2],disabled:l[3]&&l[6],shortcut:l[5],layout:l[7],$$slots:{default:[Tn]},$$scope:{ctx:l}}}),{c(){U(e.$$.fragment)},m(t,o){z(e,t,o),n=!0},p(t,[o]){const i={};o&4&&(i.content=t[2]),o&72&&(i.disabled=t[3]&&t[6]),o&32&&(i.shortcut=t[5]),o&128&&(i.layout=t[7]),o&539&&(i.$$scope={dirty:o,ctx:t}),e.$set(i)},i(t){n||(L(e.$$.fragment,t),n=!0)},o(t){A(e.$$.fragment,t),n=!1},d(t){E(e,t)}}}function On(l){l.preventDefault()}function Un(l,e,n){let{icon:t}=e,{text:o=null}=e,{tooltip:i=null}=e,{disabled:f=!1}=e,{palette:r="plain"}=e,{shortcut:s=null}=e,{disabledReason:u="disabled"}=e,{tooltipLayout:a="bottom"}=e;function c(_){he.call(this,l,_)}return l.$$set=_=>{"icon"in _&&n(0,t=_.icon),"text"in _&&n(1,o=_.text),"tooltip"in _&&n(2,i=_.tooltip),"disabled"in _&&n(3,f=_.disabled),"palette"in _&&n(4,r=_.palette),"shortcut"in _&&n(5,s=_.shortcut),"disabledReason"in _&&n(6,u=_.disabledReason),"tooltipLayout"in _&&n(7,a=_.tooltipLayout)},[t,o,i,f,r,s,u,a,c]}class le extends ee{constructor(e){super();te(this,e,Un,Hn,x,{icon:0,text:1,tooltip:2,disabled:3,palette:4,shortcut:5,disabledReason:6,tooltipLayout:7})}}function zn(l){let e,n;const t=l[1].default,o=Ie(t,l,l[0],null);return{c(){e=M("div"),o&&o.c(),y(e,"class","top svelte-p5tbxi")},m(i,f){D(i,e,f),o&&o.m(e,null),n=!0},p(i,[f]){o&&o.p&&(!n||f&1)&&Ke(o,t,i,i[0],n?We(t,i[0],f,null):Xe(i[0]),null)},i(i){n||(L(o,i),n=!0)},o(i){A(o,i),n=!1},d(i){i&&q(e),o&&o.d(i)}}}function En(l,e,n){let{$$slots:t={},$$scope:o}=e;return l.$$set=i=>{"$$scope"in i&&n(0,o=i.$$scope)},[o,t]}class qt extends ee{constructor(e){super();te(this,e,En,zn,x,{})}}function Vn(l){let e,n,t,o,i,f,r,s,u,a,c,_;return e=new le({props:{icon:"undo",disabled:l[2][l[1]].history.index==-1,tooltip:"undo",shortcut:["cmd","z"],disabledReason:"nothing to undo"}}),e.$on("click",l[7]),t=new le({props:{disabled:l[2][l[1]].history.index==l[2][l[1]].history.data.length-1,icon:"redo",tooltip:"redo",shortcut:["cmd","shift","z"],disabledReason:"nothing to redo"}}),t.$on("click",l[8]),i=new le({props:{icon:"addRight",disabled:!l[0],disabledReason:Re,tooltip:"add response",shortcut:["shift","enter"]}}),i.$on("click",l[4]),r=new le({props:{icon:"addUp",disabled:!l[0],disabledReason:Re,tooltip:"add arguement above"}}),r.$on("click",l[9]),u=new le({props:{icon:"addDown",disabled:!l[0],disabledReason:Re,tooltip:"add arguement below",shortcut:["enter"]}}),u.$on("click",l[10]),c=new le({props:{icon:"delete",disabled:!l[0],disabledReason:Re,tooltip:"delete selected"}}),c.$on("click",l[3]),{c(){U(e.$$.fragment),n=O(),U(t.$$.fragment),o=O(),U(i.$$.fragment),f=O(),U(r.$$.fragment),s=O(),U(u.$$.fragment),a=O(),U(c.$$.fragment)},m(h,F){z(e,h,F),D(h,n,F),z(t,h,F),D(h,o,F),z(i,h,F),D(h,f,F),z(r,h,F),D(h,s,F),z(u,h,F),D(h,a,F),z(c,h,F),_=!0},p(h,F){const b={};F&6&&(b.disabled=h[2][h[1]].history.index==-1),e.$set(b);const p={};F&6&&(p.disabled=h[2][h[1]].history.index==h[2][h[1]].history.data.length-1),t.$set(p);const C={};F&1&&(C.disabled=!h[0]),i.$set(C);const R={};F&1&&(R.disabled=!h[0]),r.$set(R);const K={};F&1&&(K.disabled=!h[0]),u.$set(K);const P={};F&1&&(P.disabled=!h[0]),c.$set(P)},i(h){_||(L(e.$$.fragment,h),L(t.$$.fragment,h),L(i.$$.fragment,h),L(r.$$.fragment,h),L(u.$$.fragment,h),L(c.$$.fragment,h),_=!0)},o(h){A(e.$$.fragment,h),A(t.$$.fragment,h),A(i.$$.fragment,h),A(r.$$.fragment,h),A(u.$$.fragment,h),A(c.$$.fragment,h),_=!1},d(h){E(e,h),h&&q(n),E(t,h),h&&q(o),E(i,h),h&&q(f),E(r,h),h&&q(s),E(u,h),h&&q(a),E(c,h)}}}function In(l){let e,n,t,o,i,f;return t=new qt({props:{$$slots:{default:[Vn]},$$scope:{ctx:l}}}),{c(){e=M("div"),n=M("div"),U(t.$$.fragment),y(n,"class","buttons-wrapper svelte-psed4t"),y(e,"class","top svelte-psed4t")},m(r,s){D(r,e,s),B(e,n),z(t,n,null),o=!0,i||(f=W(e,"mousedown",Kn),i=!0)},p(r,[s]){const u={};s&4103&&(u.$$scope={dirty:s,ctx:r}),t.$set(u)},i(r){o||(L(t.$$.fragment,r),o=!0)},o(r){A(t.$$.fragment,r),o=!1},d(r){r&&q(e),E(t),i=!1,f()}}}let Re="no cell selected";function Kn(l){l.preventDefault()}function Xn(l,e,n){let t,o;de(l,we,b=>n(1,t=b)),de(l,G,b=>n(2,o=b));let{flow:i}=e,f=!1;async function r(){if(await Pt(),i.lastFocus&&i.lastFocus.length>1){let b=ae(i.lastFocus);n(0,f=b==null?void 0:b.focus)}}St(function(){r()});function s(){if(!f)return;let b=ae(i.lastFocus,1),p=ae(i.lastFocus),C=[...b.children];if(C.length>1||b.level>=1){o[t].history.add("delete",i.lastFocus,{box:C[p.index]}),C.splice(p.index,1);for(let R=p.index;R<C.length;R++)C[R].index=R;C.length<=0?b.focus=!0:p.index>=C.length?C[C.length-1].focus=!0:C[p.index].focus=!0,b.children=[...C],n(6,i)}}function u(){if(!f)return;let b=ae(i.lastFocus),p=[...b.children];if(b.level<i.columns.length){p.splice(0,0,Ae(0,b.level+1,!1));for(let C=0;C<p.length;C++)p[C].index=C;o[t].history.add("add",[...i.lastFocus,0]),b.children=[...p],n(6,i)}}function a(b){if(!f)return;let p=ae(i.lastFocus,1),C=ae(i.lastFocus),R=[...p.children];R.splice(C.index+b,0,Ae(C.index+b,C.level,!1));for(let P=C.index;P<R.length;P++)R[P].index=P;let K=[...i.lastFocus];b==0?(K[K.length-1]-=0,n(6,i.lastFocus[i.lastFocus.length-1]+=1,i)):K[K.length-1]+=1,o[t].history.add("add",K),p.children=[...R],n(6,i)}const c=()=>o[t].history.undo(),_=()=>o[t].history.redo(),h=()=>a(0),F=()=>a(1);return l.$$set=b=>{"flow"in b&&n(6,i=b.flow)},[f,t,o,s,u,a,i,c,_,h,F]}class Wn extends ee{constructor(e){super();te(this,e,Xn,In,x,{flow:6})}}function Jn(l){let e,n,t,o,i,f,r;t=new le({props:{icon:"delete",tooltip:"close"}}),t.$on("click",function(){tn(l[1])&&l[1].apply(this,arguments)});var s=l[0];function u(a){return{props:{closePopup:a[1]}}}return s&&(i=new s(u(l))),{c(){e=M("div"),n=M("div"),U(t.$$.fragment),o=O(),i&&U(i.$$.fragment),y(n,"class","close svelte-1i1p7so"),y(e,"class","top svelte-1i1p7so")},m(a,c){D(a,e,c),B(e,n),z(t,n,null),B(e,o),i&&z(i,e,null),r=!0},p(a,[c]){l=a;const _={};if(c&2&&(_.closePopup=l[1]),s!==(s=l[0])){if(i){re();const h=i;A(h.$$.fragment,1,0,()=>{E(h,1)}),ue()}s?(i=new s(u(l)),U(i.$$.fragment),L(i.$$.fragment,1),z(i,e,null)):i=null}else s&&i.$set(_)},i(a){r||(L(t.$$.fragment,a),i&&L(i.$$.fragment,a),_e(()=>{f||(f=ke(e,it,{},!0)),f.run(1)}),r=!0)},o(a){A(t.$$.fragment,a),i&&A(i.$$.fragment,a),f||(f=ke(e,it,{},!1)),f.run(0),r=!1},d(a){a&&q(e),E(t),i&&E(i),a&&f&&f.end()}}}function Yn(l,e,n){let{component:t}=e,{closeSelf:o}=e;return l.$$set=i=>{"component"in i&&n(0,t=i.component),"closeSelf"in i&&n(1,o=i.closeSelf)},[t,o]}class Gn extends ee{constructor(e){super();te(this,e,Yn,Jn,x,{component:0,closeSelf:1})}}function Qn(l){let e,n,t,o,i,f,r,s,u,a,c;return t=new le({props:{icon:"download",text:"download as JSON",tooltip:"saves JSON file on your computer",tooltipLayout:"top",disabled:l[0].length==0,disabledReason:"nothing to download"}}),t.$on("click",l[1]),s=new le({props:{icon:"download",text:"download as XLSX",tooltip:"saves XLSX file on your computer",tooltipLayout:"top",disabled:l[0].length==0,disabledReason:"nothing to download"}}),s.$on("click",l[2]),{c(){e=M("div"),n=M("section"),U(t.$$.fragment),o=O(),i=M("ul"),i.innerHTML=`<li>Can reopen file in this editor</li> 
      <li>More data is saved (last focused cell etc.)</li>`,f=O(),r=M("section"),U(s.$$.fragment),u=O(),a=M("ul"),a.innerHTML="<li>Anyone can view it</li>",y(i,"class","svelte-87ygo3"),y(n,"class","json svelte-87ygo3"),y(a,"class","svelte-87ygo3"),y(r,"class","xlsx svelte-87ygo3"),y(e,"class","top svelte-87ygo3")},m(_,h){D(_,e,h),B(e,n),z(t,n,null),B(n,o),B(n,i),B(e,f),B(e,r),z(s,r,null),B(r,u),B(r,a),c=!0},p(_,[h]){const F={};h&1&&(F.disabled=_[0].length==0),t.$set(F);const b={};h&1&&(b.disabled=_[0].length==0),s.$set(b)},i(_){c||(L(t.$$.fragment,_),L(s.$$.fragment,_),c=!0)},o(_){A(t.$$.fragment,_),A(s.$$.fragment,_),c=!1},d(_){_&&q(e),E(t),E(s)}}}function Zn(l,e,n){let t;de(l,G,r=>n(0,t=r));let{closePopup:o}=e;function i(){let r=JSON.stringify(t,(u,a)=>{if(u!=="history")return a}),s=document.createElement("a");s.setAttribute("href","data:text/json;charset=utf-8, "+encodeURIComponent(r)),s.setAttribute("download","flow.json"),document.body.appendChild(s),s.click(),document.body.removeChild(s),o()}function f(){let r=new nn.exports.Workbook;for(let s of t){let a=function(F,b,p){for(;!u[p];){let C=[];for(let R=0;R<s.columns.length;R++)C.push("");u.push(C)}b>=0&&(u[p][b]=F.content),F.children.forEach(function(C,R){a(C,b+1,p+R)})},u=[];a(s,-1,0);let c=s.content;c.length>=31&&(c=c.substring(0,31));let _=r.addWorksheet(c);_.columns=s.columns.map(function(F){return{header:F,width:25}});let h;for(let F=0;F<u.length;F++){h=_.getRow(F+2);for(let b=0;b<u[F].length;b++)h.getCell(b+1).value=u[F][b]}_.getRow(1).font={bold:!0}}r.xlsx.writeBuffer({base64:!0}).then(function(s){var u=document.createElement("a"),a=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),c=URL.createObjectURL(a);u.href=c,u.download="flow.xlsx",document.body.appendChild(u),u.click(),setTimeout(function(){document.body.removeChild(u),window.URL.revokeObjectURL(c)},0)}).catch(function(s){console.log(s.message)}),o()}return l.$$set=r=>{"closePopup"in r&&n(3,o=r.closePopup)},[t,i,f,o]}class $n extends ee{constructor(e){super();te(this,e,Zn,Qn,x,{closePopup:3})}}function xn(l){let e,n,t,o,i;return n=new le({props:{icon:"upload",text:"choose file from computer",tooltip:"upload a JSON file from your computer",tooltipLayout:"top"}}),n.$on("click",el),{c(){e=M("div"),U(n.$$.fragment),t=O(),o=M("p"),o.textContent="Or drag and drop a JSON file anywhere in this window",y(o,"class","svelte-1vv9x21"),y(e,"class","top svelte-1vv9x21")},m(f,r){D(f,e,r),z(n,e,null),B(e,t),B(e,o),i=!0},p:fe,i(f){i||(L(n.$$.fragment,f),i=!0)},o(f){A(n.$$.fragment,f),i=!1},d(f){f&&q(e),E(n)}}}function el(){document.getElementById("uploadId").click()}function tl(l,e,n){let{closePopup:t}=e;return l.$$set=o=>{"closePopup"in o&&n(0,t=o.closePopup)},[t]}class nl extends ee{constructor(e){super();te(this,e,tl,xn,x,{closePopup:0})}}function ll(l){let e;return{c(){e=pe("no name")},m(n,t){D(n,e,t)},p:fe,d(n){n&&q(e)}}}function ol(l){let e=l[0].content+"",n;return{c(){n=pe(e)},m(t,o){D(t,n,o)},p(t,o){o&1&&e!==(e=t[0].content+"")&&Fe(n,e)},d(t){t&&q(n)}}}function il(l){let e,n,t,o,i,f;function r(a,c){return a[0].content?ol:ll}let s=r(l),u=s(l);return{c(){e=M("div"),n=M("button"),u.c(),y(n,"class","svelte-wa6l8r"),V(n,"selected",l[1]),V(n,"empty",l[0].content.length==0),y(e,"class",t=ie(`top palette-${l[2]}`)+" svelte-wa6l8r"),V(e,"invert",l[0].invert)},m(a,c){D(a,e,c),B(e,n),u.m(n,null),i||(f=W(n,"click",l[3]),i=!0)},p(a,[c]){s===(s=r(a))&&u?u.p(a,c):(u.d(1),u=s(a),u&&(u.c(),u.m(n,null))),c&2&&V(n,"selected",a[1]),c&1&&V(n,"empty",a[0].content.length==0),c&4&&t!==(t=ie(`top palette-${a[2]}`)+" svelte-wa6l8r")&&y(e,"class",t),c&5&&V(e,"invert",a[0].invert)},i(a){o||_e(()=>{o=Le(e,pn,{}),o.start()})},o:fe,d(a){a&&q(e),u.d(),i=!1,f()}}}function sl(l,e,n){let{flow:t}=e,{selected:o}=e,i;function f(r){he.call(this,l,r)}return l.$$set=r=>{"flow"in r&&n(0,t=r.flow),"selected"in r&&n(1,o=r.selected)},l.$$.update=()=>{l.$$.dirty&1&&(t.invert?n(2,i="accent-secondary"):n(2,i="accent"))},[t,o,i,f]}class rl extends ee{constructor(e){super();te(this,e,sl,il,x,{flow:0,selected:1})}}const{document:Oe}=ln;function vt(l,e,n){const t=l.slice();return t[30]=e[n],t[31]=e,t[32]=n,t}function wt(l,e,n){const t=l.slice();return t[33]=e[n],t[32]=n,t}function kt(l){let e,n,t,o,i,f,r=l[0],s=[];for(let a=0;a<r.length;a+=1)s[a]=yt(wt(l,r,a));const u=a=>A(s[a],1,1,()=>{s[a]=null});return{c(){e=M("div"),n=M("div");for(let a=0;a<s.length;a+=1)s[a].c();y(n,"class","popups svelte-13rvab6"),y(e,"class","screen svelte-13rvab6")},m(a,c){D(a,e,c),B(e,n);for(let _=0;_<s.length;_+=1)s[_].m(n,null);o=!0,i||(f=[W(n,"click",et(l[12])),W(e,"click",et(l[13]))],i=!0)},p(a,c){if(l=a,c[0]&513){r=l[0];let _;for(_=0;_<r.length;_+=1){const h=wt(l,r,_);s[_]?(s[_].p(h,c),L(s[_],1)):(s[_]=yt(h),s[_].c(),L(s[_],1),s[_].m(n,null))}for(re(),_=r.length;_<s.length;_+=1)u(_);ue()}},i(a){if(!o){for(let c=0;c<r.length;c+=1)L(s[c]);_e(()=>{t||(t=ke(e,tt,{duration:ce},!0)),t.run(1)}),o=!0}},o(a){s=s.filter(Boolean);for(let c=0;c<s.length;c+=1)A(s[c]);t||(t=ke(e,tt,{duration:ce},!1)),t.run(0),o=!1},d(a){a&&q(e),Se(s,a),a&&t&&t.end(),i=!1,me(f)}}}function yt(l){let e,n;function t(){return l[11](l[32])}return e=new Gn({props:{component:l[33],closeSelf:t}}),{c(){U(e.$$.fragment)},m(o,i){z(e,o,i),n=!0},p(o,i){l=o;const f={};i[0]&1&&(f.component=l[33]),e.$set(f)},i(o){n||(L(e.$$.fragment,o),n=!0)},o(o){A(e.$$.fragment,o),n=!1},d(o){E(e,o)}}}function ul(l){let e,n,t,o,i,f;return e=new le({props:{icon:"settings",tooltip:"settings"}}),t=new le({props:{icon:"download",disabled:l[1].length==0,disabledReason:"nothing to download",tooltip:"download as file"}}),t.$on("click",l[14]),i=new le({props:{icon:"upload",tooltip:"import file"}}),i.$on("click",l[15]),{c(){U(e.$$.fragment),n=O(),U(t.$$.fragment),o=O(),U(i.$$.fragment)},m(r,s){z(e,r,s),D(r,n,s),z(t,r,s),D(r,o,s),z(i,r,s),f=!0},p(r,s){const u={};s[0]&2&&(u.disabled=r[1].length==0),t.$set(u)},i(r){f||(L(e.$$.fragment,r),L(t.$$.fragment,r),L(i.$$.fragment,r),f=!0)},o(r){A(e.$$.fragment,r),A(t.$$.fragment,r),A(i.$$.fragment,r),f=!1},d(r){E(e,r),r&&q(n),E(t,r),r&&q(o),E(i,r)}}}function Ft(l){let e,n,t;function o(r){l[16](r,l[32])}function i(){return l[17](l[32])}let f={selected:l[32]==l[2]};return l[1][l[32]]!==void 0&&(f.flow=l[1][l[32]]),e=new rl({props:f}),J.push(()=>Q(e,"flow",o)),e.$on("click",i),{c(){U(e.$$.fragment)},m(r,s){z(e,r,s),t=!0},p(r,s){l=r;const u={};s[0]&4&&(u.selected=l[32]==l[2]),!n&&s[0]&2&&(n=!0,u.flow=l[1][l[32]],Z(()=>n=!1)),e.$set(u)},i(r){t||(L(e.$$.fragment,r),t=!0)},o(r){A(e.$$.fragment,r),t=!1},d(r){E(e,r)}}}function Ct(l){let e,n,t,o,i,f,r,s,u,a,c,_,h,F=l[2],b,p;function C(d){l[20](d)}function R(d){l[21](d)}function K(d){l[22](d)}function P(d){l[23](d)}function T(d){l[24](d)}function I(d){l[25](d)}let m={};l[1][l[2]].content!==void 0&&(m.content=l[1][l[2]].content),l[1][l[2]].children!==void 0&&(m.children=l[1][l[2]].children),l[1][l[2]].index!==void 0&&(m.index=l[1][l[2]].index),l[1][l[2]].level!==void 0&&(m.level=l[1][l[2]].level),l[1][l[2]].focus!==void 0&&(m.focus=l[1][l[2]].focus),l[1][l[2]].invert!==void 0&&(m.invert=l[1][l[2]].invert),n=new jn({props:m}),J.push(()=>Q(n,"content",C)),J.push(()=>Q(n,"children",R)),J.push(()=>Q(n,"index",K)),J.push(()=>Q(n,"level",P)),J.push(()=>Q(n,"focus",T)),J.push(()=>Q(n,"invert",I));function se(d){l[26](d)}let H={};l[1][l[2]]!==void 0&&(H.flow=l[1][l[2]]),c=new Wn({props:H}),J.push(()=>Q(c,"flow",se));let v=Lt(l);return{c(){e=M("div"),U(n.$$.fragment),u=O(),a=M("div"),U(c.$$.fragment),h=O(),v.c(),b=De(),y(e,"class","title svelte-13rvab6"),y(a,"class","box-control svelte-13rvab6")},m(d,S){D(d,e,S),z(n,e,null),D(d,u,S),D(d,a,S),z(c,a,null),D(d,h,S),v.m(d,S),D(d,b,S),p=!0},p(d,S){const N={};!t&&S[0]&6&&(t=!0,N.content=d[1][d[2]].content,Z(()=>t=!1)),!o&&S[0]&6&&(o=!0,N.children=d[1][d[2]].children,Z(()=>o=!1)),!i&&S[0]&6&&(i=!0,N.index=d[1][d[2]].index,Z(()=>i=!1)),!f&&S[0]&6&&(f=!0,N.level=d[1][d[2]].level,Z(()=>f=!1)),!r&&S[0]&6&&(r=!0,N.focus=d[1][d[2]].focus,Z(()=>r=!1)),!s&&S[0]&6&&(s=!0,N.invert=d[1][d[2]].invert,Z(()=>s=!1)),n.$set(N);const g={};!_&&S[0]&6&&(_=!0,g.flow=d[1][d[2]],Z(()=>_=!1)),c.$set(g),S[0]&4&&x(F,F=d[2])?(re(),A(v,1,1,fe),ue(),v=Lt(d),v.c(),L(v),v.m(b.parentNode,b)):v.p(d,S)},i(d){p||(L(n.$$.fragment,d),L(c.$$.fragment,d),L(v),p=!0)},o(d){A(n.$$.fragment,d),A(c.$$.fragment,d),A(v),p=!1},d(d){d&&q(e),E(n),d&&q(u),d&&q(a),E(c),d&&q(h),d&&q(b),v.d(d)}}}function Lt(l){let e,n,t,o;function i(r){l[27](r)}let f={};return l[1][l[2]]!==void 0&&(f.root=l[1][l[2]]),n=new Dn({props:f}),J.push(()=>Q(n,"root",i)),n.$on("focusFlow",l[4]),{c(){e=M("div"),U(n.$$.fragment),y(e,"class","flow svelte-13rvab6")},m(r,s){D(r,e,s),z(n,e,null),o=!0},p(r,s){const u={};!t&&s[0]&6&&(t=!0,u.root=r[1][r[2]],Z(()=>t=!1)),n.$set(u)},i(r){o||(L(n.$$.fragment,r),o=!0)},o(r){A(n.$$.fragment,r),o=!1},d(r){r&&q(e),E(n)}}}function fl(l){let e,n,t,o,i,f,r,s,u,a,c,_,h,F,b,p,C,R,K,P,T=l[0].length>0&&kt(l);s=new qt({props:{$$slots:{default:[ul]},$$scope:{ctx:l}}});let I=l[1],m=[];for(let v=0;v<I.length;v+=1)m[v]=Ft(vt(l,I,v));const se=v=>A(m[v],1,1,()=>{m[v]=null});F=new le({props:{text:"on case",palette:"accent",icon:"add",tooltip:"create new oncase flow"}}),F.$on("click",l[18]),p=new le({props:{text:"off case",palette:"accent-secondary",icon:"add",tooltip:"create new offcase flow"}}),p.$on("click",l[19]);let H=l[1].length>0&&Ct(l);return{c(){e=O(),T&&T.c(),n=O(),t=M("input"),o=O(),i=M("main"),f=M("div"),r=M("div"),U(s.$$.fragment),u=O(),a=M("div"),c=M("ul");for(let v=0;v<m.length;v+=1)m[v].c();_=O(),h=M("div"),U(F.$$.fragment),b=O(),U(p.$$.fragment),C=O(),H&&H.c(),y(t,"id","uploadId"),y(t,"type","file"),t.hidden=!0,y(r,"class","header svelte-13rvab6"),y(h,"class","add-tab svelte-13rvab6"),y(c,"class","svelte-13rvab6"),y(a,"class","tabs svelte-13rvab6"),y(f,"class","sidebar svelte-13rvab6"),y(i,"class","palette-plain svelte-13rvab6"),y(i,"style",`--transition-speed: ${ce}ms;`)},m(v,d){D(v,e,d),T&&T.m(v,d),D(v,n,d),D(v,t,d),D(v,o,d),D(v,i,d),B(i,f),B(f,r),z(s,r,null),B(f,u),B(f,a),B(a,c);for(let S=0;S<m.length;S+=1)m[S].m(c,null);B(c,_),B(c,h),z(F,h,null),B(h,b),z(p,h,null),B(i,C),H&&H.m(i,null),R=!0,K||(P=[W(Oe.body,"keydown",l[6]),W(Oe.body,"dragenter",al),W(Oe.body,"drop",l[7]),W(t,"change",l[8])],K=!0)},p(v,d){v[0].length>0?T?(T.p(v,d),d[0]&1&&L(T,1)):(T=kt(v),T.c(),L(T,1),T.m(n.parentNode,n)):T&&(re(),A(T,1,1,()=>{T=null}),ue());const S={};if(d[0]&2|d[1]&16&&(S.$$scope={dirty:d,ctx:v}),s.$set(S),d[0]&14){I=v[1];let N;for(N=0;N<I.length;N+=1){const g=vt(v,I,N);m[N]?(m[N].p(g,d),L(m[N],1)):(m[N]=Ft(g),m[N].c(),L(m[N],1),m[N].m(c,_))}for(re(),N=I.length;N<m.length;N+=1)se(N);ue()}v[1].length>0?H?(H.p(v,d),d[0]&2&&L(H,1)):(H=Ct(v),H.c(),L(H,1),H.m(i,null)):H&&(re(),A(H,1,1,()=>{H=null}),ue())},i(v){if(!R){L(T),L(s.$$.fragment,v);for(let d=0;d<I.length;d+=1)L(m[d]);L(F.$$.fragment,v),L(p.$$.fragment,v),L(H),R=!0}},o(v){A(T),A(s.$$.fragment,v),m=m.filter(Boolean);for(let d=0;d<m.length;d+=1)A(m[d]);A(F.$$.fragment,v),A(p.$$.fragment,v),A(H),R=!1},d(v){v&&q(e),T&&T.d(v),v&&q(n),v&&q(t),v&&q(o),v&&q(i),E(s),Se(m,v),E(F),E(p),H&&H.d(),K=!1,me(P)}}}function al(l){l.preventDefault()}function cl(l,e,n){let t,o;de(l,G,w=>n(1,t=w)),de(l,we,w=>n(2,o=w));function i(w){Me(we,o=w,o),f()}function f(){var Y,$;let w=((Y=t[o])==null?void 0:Y.lastFocus)&&ae(($=t[o])==null?void 0:$.lastFocus);w?w.focus=!0:Me(G,t[o].children[0].focus=!0,t),G.set(t)}function r(){var Y,$;let w=((Y=t[o])==null?void 0:Y.lastFocus)&&ae(($=t[o])==null?void 0:$.lastFocus);w&&(w.focus=!1)}function s(w){r(),t.push(cn(t.length,w)),Me(we,o=t.length-1,o),G.set(t)}function u(w){w.ctrlKey&&w.shiftKey&&w.key=="N"?(w.preventDefault(),s("aff")):w.ctrlKey&&w.key=="n"&&(w.preventDefault(),s("neg")),w.metaKey&&w.shiftKey&&w.key=="z"?(w.preventDefault(),t[o].history.redo()):w.metaKey&&w.key=="z"&&(w.preventDefault(),t[o].history.undo())}function a(w){w.preventDefault();let Y=w.dataTransfer.files[0],$=new FileReader;$.onload=function(qe){_(qe.target.result)},$.readAsText(Y,"UTF-8")}function c(){let w=document.getElementById("uploadId").files[0],Y=new FileReader;Y.onload=function($){_($.target.result)},Y.readAsText(w,"UTF-8")}function _(w){let Y=JSON.parse(w);Me(G,t=[],t);for(let $ of Y)$.history=new Bt,t.push($)}window.addEventListener("dragover",function(w){w.preventDefault()},!1),window.addEventListener("drop",function(w){w.preventDefault()},!1);let h=[];function F(w){h.splice(w,1),n(0,h)}function b(w){h.push(w),n(0,h)}const p=w=>F(w),C=()=>{h.length==1&&F(0)},R=()=>{h.length==1&&F(0)},K=()=>b($n),P=()=>b(nl);function T(w,Y){l.$$.not_equal(t[Y],w)&&(t[Y]=w,G.set(t))}const I=w=>i(w),m=()=>s("aff"),se=()=>s("neg");function H(w){l.$$.not_equal(t[o].content,w)&&(t[o].content=w,G.set(t))}function v(w){l.$$.not_equal(t[o].children,w)&&(t[o].children=w,G.set(t))}function d(w){l.$$.not_equal(t[o].index,w)&&(t[o].index=w,G.set(t))}function S(w){l.$$.not_equal(t[o].level,w)&&(t[o].level=w,G.set(t))}function N(w){l.$$.not_equal(t[o].focus,w)&&(t[o].focus=w,G.set(t))}function g(w){l.$$.not_equal(t[o].invert,w)&&(t[o].invert=w,G.set(t))}function j(w){l.$$.not_equal(t[o],w)&&(t[o]=w,G.set(t))}function oe(w){l.$$.not_equal(t[o],w)&&(t[o]=w,G.set(t))}return window.document.body.classList.add("dark"),[h,t,o,i,f,s,u,a,c,F,b,p,C,R,K,P,T,I,m,se,H,v,d,S,N,g,j,oe]}class dl extends ee{constructor(e){super();te(this,e,cl,fl,x,{},null,[-1,-1])}}new dl({target:document.body});
