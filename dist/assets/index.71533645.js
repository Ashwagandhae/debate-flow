var Et=Object.defineProperty;var Xe=Object.getOwnPropertySymbols;var Vt=Object.prototype.hasOwnProperty,It=Object.prototype.propertyIsEnumerable;var We=(t,e,n)=>e in t?Et(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Je=(t,e)=>{for(var n in e||(e={}))Vt.call(e,n)&&We(t,n,e[n]);if(Xe)for(var n of Xe(e))It.call(e,n)&&We(t,n,e[n]);return t};import{S as ne,i as le,s as x,e as P,a as F,b as N,c as Ye,l as X,n as fe,d as j,r as _e,f as Oe,g as ce,h as W,j as Kt,w as Ue,q as we,k as zt,m as G,o as O,p as U,t as A,u as he,v as Fe,x as B,y as E,z as Pe,A as Q,B as I,C as H,D,E as re,F as ue,G as Xt,H as Ne,I as de,J as wt,K as Ge,L as Wt,M as Jt,N as Ee,O as Ve,P as Ie,Q as Ke,R as ke,T as Se,U as Le,V as ve,W as Re,X as Qe,Y as Yt,Z as Gt,_ as Qt,$ as Ze,a0 as Zt,a1 as $e,a2 as Ae}from"./vendor.fee25846.js";const $t=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&l(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}};$t();function xt(t){let e,n,l,o;return{c(){e=P("textarea"),F(e,"spellcheck","false"),F(e,"placeholder",t[1]),F(e,"style",n=`--white-space:${t[2]};`),F(e,"class","svelte-bmiljn")},m(i,a){N(i,e,a),Ye(e,t[0]),t[12](e),l||(o=[X(e,"input",t[11]),X(e,"load",t[4]),X(e,"input",t[4]),X(e,"beforeinput",t[7]),X(e,"keydown",t[8]),X(e,"focus",t[9]),X(e,"blur",t[10])],l=!0)},p(i,[a]){a&2&&F(e,"placeholder",i[1]),a&4&&n!==(n=`--white-space:${i[2]};`)&&F(e,"style",n),a&1&&Ye(e,i[0])},i:fe,o:fe,d(i){i&&j(e),t[12](null),l=!1,_e(o)}}}function en(t,e,n){let{value:l}=e,{placeholder:o=""}=e,{nowrap:i=!1}=e,a,r;function s(){n(3,r.value=r.value.replace(/\r?\n|\r/g,""),r),n(3,r.style.height="0px",r),n(3,r.style.height=r.scrollHeight+"px",r)}Oe(function(){s()});const u=()=>{r.focus()};function f(p){ce.call(this,t,p)}function _(p){ce.call(this,t,p)}function c(p){ce.call(this,t,p)}function h(p){ce.call(this,t,p)}function k(){l=this.value,n(0,l)}function m(p){W[p?"unshift":"push"](()=>{r=p,n(3,r)})}return t.$$set=p=>{"value"in p&&n(0,l=p.value),"placeholder"in p&&n(1,o=p.placeholder),"nowrap"in p&&n(5,i=p.nowrap)},t.$$.update=()=>{t.$$.dirty&32&&(i?n(2,a="nowrap"):n(2,a="auto"))},[l,o,a,r,s,i,u,f,_,c,h,k,m]}class kt extends ne{constructor(e){super();le(this,e,en,xt,x,{value:0,placeholder:1,nowrap:5,focus:6})}get focus(){return this.$$.ctx[6]}}function tn(t){let e,n=t[1].svg+"",l;return{c(){e=Kt("svg"),F(e,"style",l=`width:${t[0]};height:${t[0]};display:block;margin:auto;`),F(e,"viewBox","0 0 "+100+" "+100),F(e,"fill","none"),F(e,"stroke","var(--color)")},m(o,i){N(o,e,i),e.innerHTML=n},p(o,[i]){i&1&&l!==(l=`width:${o[0]};height:${o[0]};display:block;margin:auto;`)&&F(e,"style",l)},i:fe,o:fe,d(o){o&&j(e)}}}function nn(t,e,n){let{name:l}=e,{size:o="1rem"}=e,a=[{name:"arrowRight",svg:'<path d="M27 7L74 50L27 93" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>'},{name:"arrowLeft",svg:'<path d="M74 93L27 50L74 7" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>'},{name:"arrowUp",svg:'<path d="M7.5 73.5L50.5 26.5L93.5 73.5" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>'},{name:"arrowDown",svg:'<path d="M93.5 26.5L50.5 73.5L7.5 26.5" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>'},{name:"delete",svg:`<path d="M78.5685 22L22 78.5685" stroke-width="10" stroke-linecap="round"/>
<path d="M22 22L78.5685 78.5685" stroke-width="10" stroke-linecap="round"/>`},{name:"add",svg:`<path d="M50 15L50 85" stroke-width="10" stroke-linecap="round"/>
<path d="M15 50H85" stroke-width="10" stroke-linecap="round"/>`},{name:"download",svg:`<path d="M71 45L50 68L29 45" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M20 85L80 85" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M50 66L50 14" stroke-width="10" stroke-linecap="round"/>`},{name:"upload",svg:`<path d="M29 37L50 14L71 37" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M20 85L80 85" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M50 16L50 68" stroke-width="10" stroke-linecap="round"/>`},{name:"addUp",svg:`<path d="M85 25V25C87.7614 25 90 27.2386 90 30V70C90 75.5228 85.5228 80 80 80H20C14.4772 80 10 75.5228 10 70L10 30C10 27.2386 12.2386 25 15 25V25" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M35 25H65" stroke-width="10" stroke-linecap="round"/>
<path d="M50 40V10" stroke-width="10" stroke-linecap="round"/>`},{name:"addDown",svg:`<path d="M15 75V75C12.2386 75 10 72.7614 10 70L10 30C10 24.4772 14.4772 20 20 20L80 20C85.5228 20 90 24.4772 90 30L90 70C90 72.7614 87.7614 75 85 75V75" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M65 75H35" stroke-width="10" stroke-linecap="round"/>
<path d="M50 60L50 90" stroke-width="10" stroke-linecap="round"/>`},{name:"addRight",svg:`<path d="M75 85V85C75 87.7614 72.7614 90 70 90H30C24.4772 90 20 85.5228 20 80V20C20 14.4772 24.4772 10 30 10H70C72.7614 10 75 12.2386 75 15V15" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M75 35V65" stroke-width="10" stroke-linecap="round"/>
<path d="M60 50H90" stroke-width="10" stroke-linecap="round"/>`},{name:"undo",svg:`<path d="M10 47H70C81.0457 47 90 55.9543 90 67V77" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M36 70L10 47L36 24" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>`},{name:"redo",svg:`<path d="M90 47H30C18.9543 47 10 55.9543 10 67V77" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M64 70L90 47L64 24" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>`}].find(r=>r.name===l);return t.$$set=r=>{"name"in r&&n(2,l=r.name),"size"in r&&n(0,o=r.size)},[o,a,l]}class yt extends ne{constructor(e){super();le(this,e,nn,tn,x,{name:2,size:0})}}const Z=Ue([]);let be=Ue(0);const ln=Ue({aff:{columns:["1AC","1NC","2AC","2NC/1NR","1AR","2NR","2AR"],invert:!1},neg:{columns:["1NC","2AC","2NC/1NR","1AR","2NR","2AR"],invert:!0}});let Be;Z.subscribe(t=>{Be=t});let Te;ln.subscribe(t=>{Te=t});function Ce(t,e,n){return{content:"",children:[],index:t,level:e,focus:n}}function on(t,e){return{content:"",level:0,columns:Te[e].columns,invert:Te[e].invert,focus:!0,index:t,lastFocus:void 0,children:[Ce(0,1,!1)],history:new Ft}}function se(t,e){e||(e=0);let n={children:Be};for(let l=0;l<t.length-e;l++)n=n.children[t[l]];return n}class Ft{constructor(){this.index=-1,this.data=[],this.lastFocus=void 0}lastAction(){return this.data[this.index]}add(e,n,l){this.resolveAllPending();let o={type:e,path:n,lastFocus:[...this.lastFocus],nextFocus:void 0};o.type=="delete"&&(o.box=Je({},l.box)),this.data=this.data.slice(0,this.index+1),this.data.push(o),this.index=this.data.length-1}addPending(e,n,l){this.data=this.data.slice(0,this.index+1),this.data.push({type:e,pending:!0,path:n,other:l}),this.index=this.data.length-1}resolveAllPending(){let e=!1;for(let n=0;n<this.data.length;n++){let l=this.data[n];if(l.pending){let o={type:l.type,path:l.path,lastFocus:l.path,nextFocus:l.path},i=!0;o.type=="edit"&&(o.lastContent=l.other.lastContent,o.nextContent=l.other.getNextContent(),o.lastContent==o.nextContent&&(i=!1),l.other.createEditBreak()),i?(e=!0,this.data[n]=o):(this.data[n]=null,this.index>=n&&(this.index-=1))}}this.data=this.data.filter(n=>n!=null),e&&console.log("resolving all pending")}addFocus(e){this.lastFocus=e,this.lastAction()&&this.lastAction().nextFocus==null&&(this.lastAction().nextFocus=e)}undoAction(e){console.log("undo",this.index,this.data);let n=se(e.path,1),l=e.path[e.path.length-1],o=[...n.children];e.type=="add"?o.splice(l,1):e.type=="delete"?o.splice(l,0,e.box):e.type=="edit"&&(o[l].content=e.lastContent);for(let i=l;i<o.length;i++)o[i].index=i;n.children=[...o]}redoAction(e){console.log("redo",this.index,this.data);let n=se(e.path,1),l=e.path[e.path.length-1],o=[...n.children];e.type=="add"?o.splice(l,0,Ce(l,n.level+1,!1)):e.type=="delete"?o.splice(l,1):e.type=="edit"&&(o[l].content=e.nextContent);for(let i=l;i<o.length;i++)o[i].index=i;n.children=[...o]}focus(e){let n=se(e);n.focus=!0}undo(){if(this.resolveAllPending(),this.index>-1){let e=this.lastAction();this.undoAction(e),this.focus(e.lastFocus),Z.set(Be),this.index-=1}}redo(){if(this.resolveAllPending(),this.index<this.data.length-1){this.index+=1;let e=this.lastAction();this.redoAction(e),this.focus(e.nextFocus),Z.set(Be)}}}const ae=300;function sn(t,{duration:e=ae}){const n=t.clientHeight;return{duration:e,css:l=>{const o=we(l);return`
        height: ${o*n}px;
        overflow: visible;
        clip-path: inset(${(1-o)*n-2}px 0 -${n}px 0);
        transform: translateY(${(1-o)*-n}px);
        `}}}function rn(t,{duration:e=ae}){const n=t.clientHeight;return{duration:e,css:l=>{const o=we(l);return`
        height: ${o*n}px;
        overflow: visible;
        clip-path: inset(${(1-o)*n}px 0 0 0);
        transform: translateY(${(1-o)*-n}px);
        `}}}function un(t,{delay:e=0,duration:n=ae}){return{delay:e,duration:n,css:l=>`
        opacity:${l};
      `}}function xe(t,{delay:e=0,duration:n=ae}){return{delay:e,duration:n,css:l=>{const o=we(l);return`
        clip-path:inset(0% ${(1-o)*100}% 0% 0%);
        transform: translateX(${(1-o)*50}%);
      `}}}function et(t,{delay:e=0,duration:n=ae}){return{delay:e,duration:n,css:l=>{const o=zt(l);return`
      clip-path:inset(0% ${(1-o)*100}% 0% 0%);
      transform: translateX(${(1-o)*50}%)`}}}function fn(t,{duration:e=ae}){const n=t.clientHeight;return{duration:e,css:l=>{const o=we(l);return`
        height: ${n*o}px;
        overflow: hidden;
        transform: translateX(${-100*(1-o)}%);
      `}}}function tt(t,{delay:e=0,duration:n=ae}){return{delay:e,duration:n,css:l=>`
        transform: scale(${we(l)});
        opacity: ${l};
      `}}function nt(t,{delay:e=0,duration:n=ae}){return{delay:e,duration:n,css:l=>`
        transform: scale(${we(l)});
        opacity: ${l};
      `}}function lt(t,e,n){const l=t.slice();return l[51]=e[n],l[52]=e,l[53]=n,l}function ot(t){let e,n,l,o,i,a;return n=new yt({props:{name:"add"}}),{c(){e=P("button"),O(n.$$.fragment),F(e,"class","add svelte-1bx45r3")},m(r,s){N(r,e,s),U(n,e,null),o=!0,i||(a=[X(e,"click",t[32]),X(e,"mousedown",He)],i=!0)},p:fe,i(r){o||(A(n.$$.fragment,r),r&&(l||he(()=>{l=Fe(e,un,{}),l.start()})),o=!0)},o(r){B(n.$$.fragment,r),o=!1},d(r){r&&j(e),E(n),i=!1,_e(a)}}}function it(t,e){let n,l,o,i,a,r,s,u;function f(p){e[33](p,e[51])}function _(p){e[34](p,e[51])}function c(p){e[35](p,e[51])}function h(p){e[36](p,e[51])}function k(p){e[37](p,e[51])}let m={addSibling:e[20],deleteSelf:e[21],focusSibling:e[22],focusParent:e[23],dispatchSelfFocus:e[15],parentPath:e[9]};return e[51].content!==void 0&&(m.content=e[51].content),e[51].children!==void 0&&(m.children=e[51].children),e[51].index!==void 0&&(m.index=e[51].index),e[51].level!==void 0&&(m.level=e[51].level),e[51].focus!==void 0&&(m.focus=e[51].focus),l=new Ct({props:m}),W.push(()=>G(l,"content",f)),W.push(()=>G(l,"children",_)),W.push(()=>G(l,"index",c)),W.push(()=>G(l,"level",h)),W.push(()=>G(l,"focus",k)),l.$on("saveFocus",e[38]),{key:t,first:null,c(){n=Pe(),O(l.$$.fragment),this.first=n},m(p,S){N(p,n,S),U(l,p,S),u=!0},p(p,S){e=p;const y={};S[0]&512&&(y.parentPath=e[9]),!o&&S[0]&4&&(o=!0,y.content=e[51].content,Q(()=>o=!1)),!i&&S[0]&4&&(i=!0,y.children=e[51].children,Q(()=>i=!1)),!a&&S[0]&4&&(a=!0,y.index=e[51].index,Q(()=>a=!1)),!r&&S[0]&4&&(r=!0,y.level=e[51].level,Q(()=>r=!1)),!s&&S[0]&4&&(s=!0,y.focus=e[51].focus,Q(()=>s=!1)),l.$set(y)},i(p){u||(A(l.$$.fragment,p),u=!0)},o(p){B(l.$$.fragment,p),u=!1},d(p){p&&j(n),E(l,p)}}}function an(t){let e,n,l,o,i,a,r,s,u,f,_,c,h,k,m,p,S,y=[],V=new Map,J,C,z,L,ee;function T(g){t[29](g)}let b={placeholder:t[12]};t[1]!==void 0&&(b.value=t[1]),s=new kt({props:b}),W.push(()=>G(s,"value",T)),t[30](s),s.$on("keydown",t[18]),s.$on("beforeinput",t[19]),s.$on("blur",t[17]),s.$on("focus",t[16]);let d=t[2].length==0&&t[5]<t[14]&&ot(t),M=t[2];const q=g=>g[51];for(let g=0;g<M.length;g+=1){let R=lt(t,M,g),oe=q(R);V.set(oe,y[g]=it(oe,R))}return{c(){e=P("div"),n=P("div"),l=P("div"),o=P("div"),r=I(),O(s.$$.fragment),f=I(),_=P("div"),k=I(),d&&d.c(),p=I(),S=P("ul");for(let g=0;g<y.length;g+=1)y[g].c();F(o,"class","line above svelte-1bx45r3"),H(o,"left",t[2].length>0),H(o,"right",t[4]==0&&t[5]>1),F(_,"class","line below svelte-1bx45r3"),F(l,"class","barcontainer svelte-1bx45r3"),F(n,"class","content svelte-1bx45r3"),F(n,"style",m=`--this-background: ${t[11]}`),H(n,"root",t[3]),H(n,"left",t[2].length>0),H(n,"right",t[4]==0&&t[5]>1),F(S,"class","children svelte-1bx45r3"),F(e,"class","top svelte-1bx45r3"),H(e,"empty",t[2].length==0),H(e,"secondary",t[5]%2==0&&!t[13]||t[5]%2==1&&t[13]),H(e,"focus",t[0]),H(e,"childFocus",t[8]),H(e,"highlight",t[8]||t[0])},m(g,R){N(g,e,R),D(e,n),D(n,l),D(l,o),D(l,r),U(s,l,null),D(l,f),D(l,_),D(n,k),d&&d.m(n,null),D(e,p),D(e,S);for(let oe=0;oe<y.length;oe+=1)y[oe].m(S,null);z=!0,L||(ee=[X(o,"click",t[28]),X(o,"mousedown",He),X(_,"click",t[31]),X(_,"mousedown",He)],L=!0)},p(g,R){R[0]&4&&H(o,"left",g[2].length>0),R[0]&48&&H(o,"right",g[4]==0&&g[5]>1);const oe={};R[0]&4096&&(oe.placeholder=g[12]),!u&&R[0]&2&&(u=!0,oe.value=g[1],Q(()=>u=!1)),s.$set(oe),g[2].length==0&&g[5]<g[14]?d?(d.p(g,R),R[0]&36&&A(d,1)):(d=ot(g),d.c(),A(d,1),d.m(n,null)):d&&(re(),B(d,1,1,()=>{d=null}),ue()),(!z||R[0]&2048&&m!==(m=`--this-background: ${g[11]}`))&&F(n,"style",m),R[0]&8&&H(n,"root",g[3]),R[0]&4&&H(n,"left",g[2].length>0),R[0]&48&&H(n,"right",g[4]==0&&g[5]>1),R[0]&15761924&&(M=g[2],re(),y=Xt(y,R,q,1,g,M,V,S,Jt,it,null,lt),ue()),R[0]&4&&H(e,"empty",g[2].length==0),R[0]&8224&&H(e,"secondary",g[5]%2==0&&!g[13]||g[5]%2==1&&g[13]),R[0]&1&&H(e,"focus",g[0]),R[0]&256&&H(e,"childFocus",g[8]),R[0]&257&&H(e,"highlight",g[8]||g[0])},i(g){if(!z){g&&he(()=>{a&&a.end(1),i=Fe(o,xe,{}),i.start()}),A(s.$$.fragment,g),g&&he(()=>{h&&h.end(1),c=Fe(_,xe,{}),c.start()}),A(d);for(let R=0;R<M.length;R+=1)A(y[R]);g&&he(()=>{C&&C.end(1),J=Fe(e,sn,{}),J.start()}),z=!0}},o(g){i&&i.invalidate(),g&&(a=Ne(o,et,{})),B(s.$$.fragment,g),c&&c.invalidate(),g&&(h=Ne(_,et,{})),B(d);for(let R=0;R<y.length;R+=1)B(y[R]);J&&J.invalidate(),g&&(C=Ne(e,rn,{})),z=!1},d(g){g&&j(e),g&&a&&a.end(),t[30](null),E(s),g&&h&&h.end(),d&&d.d();for(let R=0;R<y.length;R+=1)y[R].d();g&&C&&C.end(),L=!1,_e(ee)}}}function He(t){t.preventDefault()}function dn(t,e,n){let l,o,i;de(t,be,v=>n(42,o=v)),de(t,Z,v=>n(43,i=v));const a=wt();let{root:r=!1}=e,{content:s}=e,{children:u}=e,{index:f}=e,{level:_}=e,{focus:c}=e,{parentPath:h=[]}=e,{addSibling:k=()=>{}}=e,{deleteSelf:m=()=>{}}=e,{focusSibling:p=()=>{}}=e,{focusParent:S=()=>{}}=e,{dispatchSelfFocus:y=()=>{}}=e;const{getinvert:V}=Ge("invert");let J=V();const{getColumnCount:C}=Ge("columnCount");let z=C(),L,ee,T=!1,b=-1;function d(v,K){K?(n(8,T=!0),b=v):v==b&&(n(8,T=!1),b=-1)}let M=!1;function q(){c?(y(f,!0),_>=1&&(i[o].history.addFocus([...l]),a("saveFocus",l),L&&L.focus())):(y(f,!1),M=!1)}Wt(q);function g(){c&&(y(f,!0),i[o].history.addFocus([...l]))}let R="";function oe(){c||ye()}function w(){c&&n(0,c=!1)}class Y{constructor(K,te=()=>!0,ge=!0,me=!0,Ut=!0){this.require=te,this.stopRepeat=ge,this.preventDefault=me,this.blur=Ut,this.handle=function(ze){return!this.require()||(this.preventDefault&&ze.preventDefault(),this.stopRepeat&&ze.repeat==!0)?!1:(this.blur&&n(0,c=!1),K(),!0)}}}const $={shift:{Enter:new Y(()=>{qe(0,0)&&pe(0,0)})},other:{Enter:new Y(()=>{k(f,1)&&p(f,1)}),Backspace:new Y(()=>{m(f)},()=>s.length==0),ArrowUp:new Y(()=>p(f,-1)),ArrowDown:new Y(()=>p(f,1)),ArrowLeft:new Y(()=>S()),ArrowRight:new Y(()=>{u.length>0?pe(0,0):p(f,1)})}};function De(v){v.shiftKey&&$.shift[v.key]?$.shift[v.key].handle(v):$.other[v.key]&&$.other[v.key].handle(v)}function St(v){M||(console.log("created pneding",l),i[o].history.addPending("edit",[...l],{lastContent:s,getNextContent(){return s},createEditBreak(){M=!1}})),M=!0}function qe(v,K){let te=v+K;if(_<z){let ge=[...u];ge.splice(te,0,Ce(te,_+1,!0));for(let me=te;me<ge.length;me++)ge[me].index=me;return i[o].history.add("add",[...l,te]),n(2,u=[...ge]),!0}else return ye(),!1}function At(v){if(u.length>1||_>=1){let K=[...u];i[o].history.add("delete",[...l,v],{box:K[v]}),K[v].focus=!1,K.splice(v,1);for(let te=v;te<K.length;te++)K[te].childIndex=te;return n(2,u=[...K]),u[v-1]?pe(v-1,0):u.length==0?ye():v==0&&pe(0,0),!0}else return!1}function pe(v,K){let te=v+K;if(te<0){ye();return}te>=u.length?u[u.length-1].children.length>0?n(2,u[u.length-1].children[0].focus=!0,u):n(2,u[v].focus=!0,u):n(2,u[te].focus=!0,u),n(2,u)}function ye(){n(0,c=!0)}const Mt=()=>{k(f,0)&&p(f,0)};function Rt(v){s=v,n(1,s)}function Bt(v){W[v?"unshift":"push"](()=>{L=v,n(10,L)})}const Pt=()=>{k(f,1)&&p(f,1)},Dt=()=>{qe(0,0),pe(0,0)};function qt(v,K){t.$$.not_equal(K.content,v)&&(K.content=v,n(2,u))}function Nt(v,K){t.$$.not_equal(K.children,v)&&(K.children=v,n(2,u))}function jt(v,K){t.$$.not_equal(K.index,v)&&(K.index=v,n(2,u))}function Tt(v,K){t.$$.not_equal(K.level,v)&&(K.level=v,n(2,u))}function Ht(v,K){t.$$.not_equal(K.focus,v)&&(K.focus=v,n(2,u))}function Ot(v){ce.call(this,t,v)}return t.$$set=v=>{"root"in v&&n(3,r=v.root),"content"in v&&n(1,s=v.content),"children"in v&&n(2,u=v.children),"index"in v&&n(4,f=v.index),"level"in v&&n(5,_=v.level),"focus"in v&&n(0,c=v.focus),"parentPath"in v&&n(24,h=v.parentPath),"addSibling"in v&&n(6,k=v.addSibling),"deleteSelf"in v&&n(25,m=v.deleteSelf),"focusSibling"in v&&n(7,p=v.focusSibling),"focusParent"in v&&n(26,S=v.focusParent),"dispatchSelfFocus"in v&&n(27,y=v.dispatchSelfFocus)},t.$$.update=()=>{t.$$.dirty[0]&16777232&&n(9,l=[...h,f]),t.$$.dirty[0]&257&&(c?n(11,ee="var(--this-background-accent)"):T?n(11,ee="var(--this-background-accent-fade)"):n(11,ee="none")),t.$$.dirty[0]&1&&q(),t.$$.dirty[0]&512&&g(),t.$$.dirty[0]&48&&(_==1&&f==0?n(12,R="type here"):n(12,R=""))},[c,s,u,r,f,_,k,p,T,l,L,ee,R,J,z,d,oe,w,De,St,qe,At,pe,ye,h,m,S,y,Mt,Rt,Bt,Pt,Dt,qt,Nt,jt,Tt,Ht,Ot]}class Ct extends ne{constructor(e){super();le(this,e,dn,an,x,{root:3,content:1,children:2,index:4,level:5,focus:0,parentPath:24,addSibling:6,deleteSelf:25,focusSibling:7,focusParent:26,dispatchSelfFocus:27},null,[-1,-1])}}function cn(t){let e;const n=t[12].default,l=Ee(n,t,t[11],null);return{c(){l&&l.c()},m(o,i){l&&l.m(o,i),e=!0},p(o,i){l&&l.p&&(!e||i&2048)&&Ve(l,n,o,o[11],e?Ke(n,o[11],i,null):Ie(o[11]),null)},i(o){e||(A(l,o),e=!0)},o(o){B(l,o),e=!1},d(o){l&&l.d(o)}}}function hn(t){let e,n,l,o,i,a;const r=t[12].default,s=Ee(r,t,t[11],null);let u=t[2]&&st(t);return{c(){e=P("div"),s&&s.c(),n=I(),u&&u.c(),l=Pe(),F(e,"class","element svelte-vxyg3r")},m(f,_){N(f,e,_),s&&s.m(e,null),t[13](e),N(f,n,_),u&&u.m(f,_),N(f,l,_),o=!0,i||(a=[X(e,"mouseover",t[7]),X(e,"focus",t[7]),X(e,"mouseleave",t[9]),X(e,"blur",t[9]),X(e,"mousemove",t[8])],i=!0)},p(f,_){s&&s.p&&(!o||_&2048)&&Ve(s,r,f,f[11],o?Ke(r,f[11],_,null):Ie(f[11]),null),f[2]?u?(u.p(f,_),_&4&&A(u,1)):(u=st(f),u.c(),A(u,1),u.m(l.parentNode,l)):u&&(re(),B(u,1,1,()=>{u=null}),ue())},i(f){o||(A(s,f),A(u),o=!0)},o(f){B(s,f),B(u),o=!1},d(f){f&&j(e),s&&s.d(f),t[13](null),f&&j(n),u&&u.d(f),f&&j(l),i=!1,_e(a)}}}function st(t){let e,n,l,o,i,a,r=t[1]&&rt(t);return{c(){e=P("div"),n=P("div"),l=ke(t[0]),o=I(),r&&r.c(),F(n,"class","content"),Se(e,"top",t[4]+"px"),Se(e,"left",t[3]+"px"),F(e,"class","tooltip svelte-vxyg3r")},m(s,u){N(s,e,u),D(e,n),D(n,l),D(e,o),r&&r.m(e,null),t[14](e),a=!0},p(s,u){(!a||u&1)&&Le(l,s[0]),s[1]?r?r.p(s,u):(r=rt(s),r.c(),r.m(e,null)):r&&(r.d(1),r=null),(!a||u&16)&&Se(e,"top",s[4]+"px"),(!a||u&8)&&Se(e,"left",s[3]+"px")},i(s){a||(he(()=>{i||(i=ve(e,tt,{},!0)),i.run(1)}),a=!0)},o(s){i||(i=ve(e,tt,{},!1)),i.run(0),a=!1},d(s){s&&j(e),r&&r.d(),t[14](null),s&&i&&i.end()}}}function rt(t){let e,n;return{c(){e=P("div"),n=ke(t[1]),F(e,"class","disabled svelte-vxyg3r")},m(l,o){N(l,e,o),D(e,n)},p(l,o){o&2&&Le(n,l[1])},d(l){l&&j(e)}}}function _n(t){let e,n,l,o;const i=[hn,cn],a=[];function r(s,u){return s[0]?0:1}return e=r(t),n=a[e]=i[e](t),{c(){n.c(),l=Pe()},m(s,u){a[e].m(s,u),N(s,l,u),o=!0},p(s,[u]){let f=e;e=r(s),e===f?a[e].p(s,u):(re(),B(a[f],1,1,()=>{a[f]=null}),ue(),n=a[e],n?n.p(s,u):(n=a[e]=i[e](s),n.c()),A(n,1),n.m(l.parentNode,l))},i(s){o||(A(n),o=!0)},o(s){B(n),o=!1},d(s){a[e].d(s),s&&j(l)}}}function pn(t,e,n){let{$$slots:l={},$$scope:o}=e,{content:i=""}=e,{disabled:a=!1}=e,{layout:r="bottom"}=e,s=!1,u,f,_,c;function h(y){n(2,s=!0),k()}function k(y){if(c){let V=_.getBoundingClientRect();n(3,u=V.left-c.offsetWidth/2+V.width/2),u<4?n(3,u=4):u+c.offsetWidth>window.innerWidth-4&&n(3,u=window.innerWidth-c.offsetWidth-4),r=="bottom"?n(4,f=V.bottom+4):n(4,f=V.top-c.offsetHeight-4)}}function m(){n(2,s=!1)}function p(y){W[y?"unshift":"push"](()=>{_=y,n(5,_)})}function S(y){W[y?"unshift":"push"](()=>{c=y,n(6,c)})}return t.$$set=y=>{"content"in y&&n(0,i=y.content),"disabled"in y&&n(1,a=y.disabled),"layout"in y&&n(10,r=y.layout),"$$scope"in y&&n(11,o=y.$$scope)},[i,a,s,u,f,_,c,h,k,m,r,o,l,p,S]}class gn extends ne{constructor(e){super();le(this,e,pn,_n,x,{content:0,disabled:1,layout:10})}}function mn(t){let e,n;return{c(){e=P("div"),n=ke(t[0]),F(e,"class","top svelte-syszad")},m(l,o){N(l,e,o),D(e,n)},p(l,[o]){o&1&&Le(n,l[0])},i:fe,o:fe,d(l){l&&j(e)}}}function bn(t,e,n){wt();let{column:l}=e;return t.$$set=o=>{"column"in o&&n(0,l=o.column)},[l]}class vn extends ne{constructor(e){super();le(this,e,bn,mn,x,{column:0})}}function ut(t,e,n){const l=t.slice();return l[9]=e[n],l}function ft(t,e,n){const l=t.slice();return l[12]=e[n],l[13]=e,l[14]=n,l}function at(t){let e,n,l,o,i;function a(s){t[7](s,t[12],t[13],t[14])}let r={};return t[12]!==void 0&&(r.column=t[12]),n=new vn({props:r}),W.push(()=>G(n,"column",a)),n.$on("focusFlow",t[8]),{c(){e=P("h1"),O(n.$$.fragment),o=I(),F(e,"class","header svelte-1hv2yxa")},m(s,u){N(s,e,u),U(n,e,null),D(e,o),i=!0},p(s,u){t=s;const f={};!l&&u&1&&(l=!0,f.column=t[12],Q(()=>l=!1)),n.$set(f)},i(s){i||(A(n.$$.fragment,s),i=!0)},o(s){B(n.$$.fragment,s),i=!1},d(s){s&&j(e),E(n)}}}function dt(t){let e;return{c(){e=P("div"),F(e,"class","column svelte-1hv2yxa")},m(n,l){N(n,e,l)},d(n){n&&j(e)}}}function wn(t){let e,n,l,o,i,a,r,s,u,f,_,c,h,k,m;function p(d){t[2](d)}function S(d){t[3](d)}function y(d){t[4](d)}function V(d){t[5](d)}function J(d){t[6](d)}let C={root:!0};t[0].content!==void 0&&(C.content=t[0].content),t[0].children!==void 0&&(C.children=t[0].children),t[0].index!==void 0&&(C.index=t[0].index),t[0].level!==void 0&&(C.level=t[0].level),t[0].focus!==void 0&&(C.focus=t[0].focus),o=new Ct({props:C}),W.push(()=>G(o,"content",p)),W.push(()=>G(o,"children",S)),W.push(()=>G(o,"index",y)),W.push(()=>G(o,"level",V)),W.push(()=>G(o,"focus",J)),o.$on("saveFocus",t[1]);let z=t[0].columns,L=[];for(let d=0;d<z.length;d+=1)L[d]=at(ft(t,z,d));const ee=d=>B(L[d],1,1,()=>{L[d]=null});let T=t[0].columns,b=[];for(let d=0;d<T.length;d+=1)b[d]=dt(ut(t,T,d));return{c(){e=P("div"),n=P("div"),l=P("div"),O(o.$$.fragment),f=I(),_=P("div");for(let d=0;d<L.length;d+=1)L[d].c();c=I(),h=P("div");for(let d=0;d<b.length;d+=1)b[d].c();F(l,"class","content svelte-1hv2yxa"),F(_,"class","headers svelte-1hv2yxa"),F(h,"class","columns svelte-1hv2yxa"),F(n,"class","viewer svelte-1hv2yxa"),F(e,"class","top svelte-1hv2yxa"),F(e,"style",k=`--column-count: ${t[0].columns.length};`),H(e,"invert",t[0].invert)},m(d,M){N(d,e,M),D(e,n),D(n,l),U(o,l,null),D(n,f),D(n,_);for(let q=0;q<L.length;q+=1)L[q].m(_,null);D(n,c),D(n,h);for(let q=0;q<b.length;q+=1)b[q].m(h,null);m=!0},p(d,[M]){const q={};if(!i&&M&1&&(i=!0,q.content=d[0].content,Q(()=>i=!1)),!a&&M&1&&(a=!0,q.children=d[0].children,Q(()=>a=!1)),!r&&M&1&&(r=!0,q.index=d[0].index,Q(()=>r=!1)),!s&&M&1&&(s=!0,q.level=d[0].level,Q(()=>s=!1)),!u&&M&1&&(u=!0,q.focus=d[0].focus,Q(()=>u=!1)),o.$set(q),M&1){z=d[0].columns;let g;for(g=0;g<z.length;g+=1){const R=ft(d,z,g);L[g]?(L[g].p(R,M),A(L[g],1)):(L[g]=at(R),L[g].c(),A(L[g],1),L[g].m(_,null))}for(re(),g=z.length;g<L.length;g+=1)ee(g);ue()}if(M&1){const g=T.length;T=d[0].columns;let R;for(R=g;R<T.length;R+=1)ut(d,T,R),b[R]||(b[R]=dt(),b[R].c(),b[R].m(h,null));for(R=T.length;R<g;R+=1)b[R].d(1);b.length=T.length}(!m||M&1&&k!==(k=`--column-count: ${d[0].columns.length};`))&&F(e,"style",k),M&1&&H(e,"invert",d[0].invert)},i(d){if(!m){A(o.$$.fragment,d);for(let M=0;M<z.length;M+=1)A(L[M]);m=!0}},o(d){B(o.$$.fragment,d),L=L.filter(Boolean);for(let M=0;M<L.length;M+=1)B(L[M]);m=!1},d(d){d&&j(e),E(o),Re(L,d),Re(b,d)}}}function kn(t,e,n){let{root:l}=e;Qe("invert",{getinvert:()=>l.invert}),Qe("columnCount",{getColumnCount:()=>l.columns.length});function o(c){n(0,l.lastFocus=c.detail,l),n(0,l)}function i(c){t.$$.not_equal(l.content,c)&&(l.content=c,n(0,l))}function a(c){t.$$.not_equal(l.children,c)&&(l.children=c,n(0,l))}function r(c){t.$$.not_equal(l.index,c)&&(l.index=c,n(0,l))}function s(c){t.$$.not_equal(l.level,c)&&(l.level=c,n(0,l))}function u(c){t.$$.not_equal(l.focus,c)&&(l.focus=c,n(0,l))}function f(c,h,k,m){k[m]=c,n(0,l)}function _(c){ce.call(this,t,c)}return t.$$set=c=>{"root"in c&&n(0,l=c.root)},[l,o,i,a,r,s,u,f,_]}class yn extends ne{constructor(e){super();le(this,e,kn,wn,x,{root:0})}}function Fn(t){let e,n,l,o,i;function a(s){t[11](s)}let r={nowrap:!0,placeholder:"type name here"};return t[1]!==void 0&&(r.value=t[1]),l=new kt({props:r}),W.push(()=>G(l,"value",a)),t[12](l),l.$on("blur",t[4]),l.$on("focus",t[5]),l.$on("keydown",t[6]),l.$on("beforeinput",t[7]),{c(){e=P("div"),n=P("div"),O(l.$$.fragment),F(n,"class","content svelte-1es3klh"),H(n,"focus",t[0]),F(e,"class","top svelte-1es3klh"),H(e,"invert",t[2])},m(s,u){N(s,e,u),D(e,n),U(l,n,null),i=!0},p(s,[u]){const f={};!o&&u&2&&(o=!0,f.value=s[1],Q(()=>o=!1)),l.$set(f),u&1&&H(n,"focus",s[0]),u&4&&H(e,"invert",s[2])},i(s){i||(A(l.$$.fragment,s),i=!0)},o(s){B(l.$$.fragment,s),i=!1},d(s){s&&j(e),t[12](null),E(l)}}}function Cn(t,e,n){let l,o,i;de(t,be,C=>n(16,o=C)),de(t,Z,C=>n(17,i=C));let{content:a}=e,{children:r}=e,{index:s}=e,{level:u}=e,{focus:f}=e,{invert:_}=e,c;Oe(function(){f&&c.focus()});function h(){f&&n(0,f=!1)}function k(){f||n(0,f=!0)}function m(C){(C.key=="Enter"||C.key=="ArrowDown")&&(C.preventDefault(),r.length>0&&(n(8,r[0].focus=!0,r),n(0,f=!1)))}let p=!1;function S(){f?u>=1&&(i[o].history.addFocus([...l]),dispatch("saveFocus",l),c&&c.focus()):p=!1}function y(C){p||(console.log("created pneding",l),i[o].history.addPending("edit",[...l],{lastContent:a,getNextContent(){return a},createEditBreak(){p=!1}})),p=!0}function V(C){a=C,n(1,a)}function J(C){W[C?"unshift":"push"](()=>{c=C,n(3,c)})}return t.$$set=C=>{"content"in C&&n(1,a=C.content),"children"in C&&n(8,r=C.children),"index"in C&&n(9,s=C.index),"level"in C&&n(10,u=C.level),"focus"in C&&n(0,f=C.focus),"invert"in C&&n(2,_=C.invert)},t.$$.update=()=>{t.$$.dirty&512&&(l=[s]),t.$$.dirty&1,t.$$.dirty&1&&S()},[f,a,_,c,h,k,m,y,r,s,u,V,J]}class Ln extends ne{constructor(e){super();le(this,e,Cn,Fn,x,{content:1,children:8,index:9,level:10,focus:0,invert:2})}}function ct(t){let e,n;return{c(){e=P("p"),n=ke(t[1]),F(e,"class","svelte-1t2p050")},m(l,o){N(l,e,o),D(e,n)},p(l,o){o&2&&Le(n,l[1])},d(l){l&&j(e)}}}function Sn(t){let e,n,l,o,i,a;n=new yt({props:{name:t[0],size:"var(--button-size)"}});let r=t[1]&&ct(t);return{c(){e=P("button"),O(n.$$.fragment),l=I(),r&&r.c(),F(e,"class","top svelte-1t2p050"),e.disabled=t[3],H(e,"disabled",t[3])},m(s,u){N(s,e,u),U(n,e,null),D(e,l),r&&r.m(e,null),o=!0,i||(a=[X(e,"click",t[6]),X(e,"mousedown",Mn)],i=!0)},p(s,u){const f={};u&1&&(f.name=s[0]),n.$set(f),s[1]?r?r.p(s,u):(r=ct(s),r.c(),r.m(e,null)):r&&(r.d(1),r=null),(!o||u&8)&&(e.disabled=s[3]),u&8&&H(e,"disabled",s[3])},i(s){o||(A(n.$$.fragment,s),o=!0)},o(s){B(n.$$.fragment,s),o=!1},d(s){s&&j(e),E(n),r&&r.d(),i=!1,_e(a)}}}function An(t){let e,n;return e=new gn({props:{content:t[2],disabled:t[3]&&t[4],layout:t[5],$$slots:{default:[Sn]},$$scope:{ctx:t}}}),{c(){O(e.$$.fragment)},m(l,o){U(e,l,o),n=!0},p(l,[o]){const i={};o&4&&(i.content=l[2]),o&24&&(i.disabled=l[3]&&l[4]),o&32&&(i.layout=l[5]),o&139&&(i.$$scope={dirty:o,ctx:l}),e.$set(i)},i(l){n||(A(e.$$.fragment,l),n=!0)},o(l){B(e.$$.fragment,l),n=!1},d(l){E(e,l)}}}function Mn(t){t.preventDefault()}function Rn(t,e,n){let{icon:l}=e,{text:o=null}=e,{tooltip:i=null}=e,{disabled:a=!1}=e,{disabledReason:r="disabled"}=e,{tooltipLayout:s="bottom"}=e;function u(f){ce.call(this,t,f)}return t.$$set=f=>{"icon"in f&&n(0,l=f.icon),"text"in f&&n(1,o=f.text),"tooltip"in f&&n(2,i=f.tooltip),"disabled"in f&&n(3,a=f.disabled),"disabledReason"in f&&n(4,r=f.disabledReason),"tooltipLayout"in f&&n(5,s=f.tooltipLayout)},[l,o,i,a,r,s,u]}class ie extends ne{constructor(e){super();le(this,e,Rn,An,x,{icon:0,text:1,tooltip:2,disabled:3,disabledReason:4,tooltipLayout:5})}}function Bn(t){let e,n;const l=t[1].default,o=Ee(l,t,t[0],null);return{c(){e=P("div"),o&&o.c(),F(e,"class","top svelte-p5tbxi")},m(i,a){N(i,e,a),o&&o.m(e,null),n=!0},p(i,[a]){o&&o.p&&(!n||a&1)&&Ve(o,l,i,i[0],n?Ke(l,i[0],a,null):Ie(i[0]),null)},i(i){n||(A(o,i),n=!0)},o(i){B(o,i),n=!1},d(i){i&&j(e),o&&o.d(i)}}}function Pn(t,e,n){let{$$slots:l={},$$scope:o}=e;return t.$$set=i=>{"$$scope"in i&&n(0,o=i.$$scope)},[o,l]}class Lt extends ne{constructor(e){super();le(this,e,Pn,Bn,x,{})}}function Dn(t){let e,n,l,o,i,a,r,s,u,f,_,c;return e=new ie({props:{icon:"undo",disabled:t[2][t[1]].history.index==-1,tooltip:"undo",disabledReason:"nothing to undo"}}),e.$on("click",t[7]),l=new ie({props:{disabled:t[2][t[1]].history.index==t[2][t[1]].history.data.length-1,icon:"redo",tooltip:"redo",disabledReason:"nothing to redo"}}),l.$on("click",t[8]),i=new ie({props:{icon:"addRight",disabled:!t[0],disabledReason:Me,tooltip:"add response"}}),i.$on("click",t[4]),r=new ie({props:{icon:"addUp",disabled:!t[0],disabledReason:Me,tooltip:"add arguement above"}}),r.$on("click",t[9]),u=new ie({props:{icon:"addDown",disabled:!t[0],disabledReason:Me,tooltip:"add arguement below"}}),u.$on("click",t[10]),_=new ie({props:{icon:"delete",disabled:!t[0],disabledReason:Me,tooltip:"delete selected"}}),_.$on("click",t[3]),{c(){O(e.$$.fragment),n=I(),O(l.$$.fragment),o=I(),O(i.$$.fragment),a=I(),O(r.$$.fragment),s=I(),O(u.$$.fragment),f=I(),O(_.$$.fragment)},m(h,k){U(e,h,k),N(h,n,k),U(l,h,k),N(h,o,k),U(i,h,k),N(h,a,k),U(r,h,k),N(h,s,k),U(u,h,k),N(h,f,k),U(_,h,k),c=!0},p(h,k){const m={};k&6&&(m.disabled=h[2][h[1]].history.index==-1),e.$set(m);const p={};k&6&&(p.disabled=h[2][h[1]].history.index==h[2][h[1]].history.data.length-1),l.$set(p);const S={};k&1&&(S.disabled=!h[0]),i.$set(S);const y={};k&1&&(y.disabled=!h[0]),r.$set(y);const V={};k&1&&(V.disabled=!h[0]),u.$set(V);const J={};k&1&&(J.disabled=!h[0]),_.$set(J)},i(h){c||(A(e.$$.fragment,h),A(l.$$.fragment,h),A(i.$$.fragment,h),A(r.$$.fragment,h),A(u.$$.fragment,h),A(_.$$.fragment,h),c=!0)},o(h){B(e.$$.fragment,h),B(l.$$.fragment,h),B(i.$$.fragment,h),B(r.$$.fragment,h),B(u.$$.fragment,h),B(_.$$.fragment,h),c=!1},d(h){E(e,h),h&&j(n),E(l,h),h&&j(o),E(i,h),h&&j(a),E(r,h),h&&j(s),E(u,h),h&&j(f),E(_,h)}}}function qn(t){let e,n,l,o,i,a;return l=new Lt({props:{$$slots:{default:[Dn]},$$scope:{ctx:t}}}),{c(){e=P("div"),n=P("div"),O(l.$$.fragment),F(n,"class","buttons-wrapper svelte-psed4t"),F(e,"class","top svelte-psed4t")},m(r,s){N(r,e,s),D(e,n),U(l,n,null),o=!0,i||(a=X(e,"mousedown",Nn),i=!0)},p(r,[s]){const u={};s&4103&&(u.$$scope={dirty:s,ctx:r}),l.$set(u)},i(r){o||(A(l.$$.fragment,r),o=!0)},o(r){B(l.$$.fragment,r),o=!1},d(r){r&&j(e),E(l),i=!1,a()}}}let Me="no cell selected";function Nn(t){t.preventDefault()}function jn(t,e,n){let l,o;de(t,be,m=>n(1,l=m)),de(t,Z,m=>n(2,o=m));let{flow:i}=e,a=!1;async function r(){if(await Yt(),i.lastFocus&&i.lastFocus.length>1){let m=se(i.lastFocus);n(0,a=m==null?void 0:m.focus)}}Oe(function(){r()});function s(){if(!a)return;let m=se(i.lastFocus,1),p=se(i.lastFocus),S=[...m.children];if(S.length>1||m.level>=1){o[l].history.add("delete",i.lastFocus,{box:S[p.index]}),S.splice(p.index,1);for(let y=p.index;y<S.length;y++)S[y].index=y;S.length<=0?m.focus=!0:p.index>=S.length?S[S.length-1].focus=!0:S[p.index].focus=!0,m.children=[...S],n(6,i)}}function u(){if(!a)return;let m=se(i.lastFocus),p=[...m.children];if(m.level<i.columns.length){p.splice(0,0,Ce(0,m.level+1,!1));for(let S=0;S<p.length;S++)p[S].index=S;o[l].history.add("add",[...i.lastFocus,0]),m.children=[...p],n(6,i)}}function f(m){if(!a)return;let p=se(i.lastFocus,1),S=se(i.lastFocus),y=[...p.children];y.splice(S.index+m,0,Ce(S.index+m,S.level,!1));for(let J=S.index;J<y.length;J++)y[J].index=J;let V=[...i.lastFocus];m==0?(V[V.length-1]-=0,n(6,i.lastFocus[i.lastFocus.length-1]+=1,i)):V[V.length-1]+=1,o[l].history.add("add",V),p.children=[...y],n(6,i)}const _=()=>o[l].history.undo(),c=()=>o[l].history.redo(),h=()=>f(0),k=()=>f(1);return t.$$set=m=>{"flow"in m&&n(6,i=m.flow)},[a,l,o,s,u,f,i,_,c,h,k]}class Tn extends ne{constructor(e){super();le(this,e,jn,qn,x,{flow:6})}}function Hn(t){let e,n,l,o,i,a,r;l=new ie({props:{icon:"delete",tooltip:"close"}}),l.$on("click",function(){Gt(t[1])&&t[1].apply(this,arguments)});var s=t[0];function u(f){return{props:{closePopup:f[1]}}}return s&&(i=new s(u(t))),{c(){e=P("div"),n=P("div"),O(l.$$.fragment),o=I(),i&&O(i.$$.fragment),F(n,"class","close svelte-1i1p7so"),F(e,"class","top svelte-1i1p7so")},m(f,_){N(f,e,_),D(e,n),U(l,n,null),D(e,o),i&&U(i,e,null),r=!0},p(f,[_]){t=f;const c={};if(_&2&&(c.closePopup=t[1]),s!==(s=t[0])){if(i){re();const h=i;B(h.$$.fragment,1,0,()=>{E(h,1)}),ue()}s?(i=new s(u(t)),O(i.$$.fragment),A(i.$$.fragment,1),U(i,e,null)):i=null}else s&&i.$set(c)},i(f){r||(A(l.$$.fragment,f),i&&A(i.$$.fragment,f),he(()=>{a||(a=ve(e,nt,{},!0)),a.run(1)}),r=!0)},o(f){B(l.$$.fragment,f),i&&B(i.$$.fragment,f),a||(a=ve(e,nt,{},!1)),a.run(0),r=!1},d(f){f&&j(e),E(l),i&&E(i),f&&a&&a.end()}}}function On(t,e,n){let{component:l}=e,{closeSelf:o}=e;return t.$$set=i=>{"component"in i&&n(0,l=i.component),"closeSelf"in i&&n(1,o=i.closeSelf)},[l,o]}class Un extends ne{constructor(e){super();le(this,e,On,Hn,x,{component:0,closeSelf:1})}}function En(t){let e,n,l,o,i,a,r,s,u,f,_;return l=new ie({props:{icon:"download",text:"download as JSON",tooltip:"saves JSON file on your computer",tooltipLayout:"top",disabled:t[0].length==0,disabledReason:"nothing to download"}}),l.$on("click",t[1]),s=new ie({props:{icon:"download",text:"download as XLSX",tooltip:"saves XLSX file on your computer",tooltipLayout:"top",disabled:t[0].length==0,disabledReason:"nothing to download"}}),s.$on("click",t[2]),{c(){e=P("div"),n=P("section"),O(l.$$.fragment),o=I(),i=P("ul"),i.innerHTML=`<li>Can reopen file in this editor</li> 
      <li>More data is saved (last focused cell etc.)</li>`,a=I(),r=P("section"),O(s.$$.fragment),u=I(),f=P("ul"),f.innerHTML="<li>Anyone can view it</li>",F(i,"class","svelte-87ygo3"),F(n,"class","json svelte-87ygo3"),F(f,"class","svelte-87ygo3"),F(r,"class","xlsx svelte-87ygo3"),F(e,"class","top svelte-87ygo3")},m(c,h){N(c,e,h),D(e,n),U(l,n,null),D(n,o),D(n,i),D(e,a),D(e,r),U(s,r,null),D(r,u),D(r,f),_=!0},p(c,[h]){const k={};h&1&&(k.disabled=c[0].length==0),l.$set(k);const m={};h&1&&(m.disabled=c[0].length==0),s.$set(m)},i(c){_||(A(l.$$.fragment,c),A(s.$$.fragment,c),_=!0)},o(c){B(l.$$.fragment,c),B(s.$$.fragment,c),_=!1},d(c){c&&j(e),E(l),E(s)}}}function Vn(t,e,n){let l;de(t,Z,r=>n(0,l=r));let{closePopup:o}=e;function i(){let r=JSON.stringify(l,(u,f)=>{if(u!=="history")return f}),s=document.createElement("a");s.setAttribute("href","data:text/json;charset=utf-8, "+encodeURIComponent(r)),s.setAttribute("download","flow.json"),document.body.appendChild(s),s.click(),document.body.removeChild(s),o()}function a(){let r=new Qt.exports.Workbook;for(let s of l){let f=function(k,m,p){for(;!u[p];){let S=[];for(let y=0;y<s.columns.length;y++)S.push("");u.push(S)}m>=0&&(u[p][m]=k.content),k.children.forEach(function(S,y){f(S,m+1,p+y)})},u=[];f(s,-1,0);let _=s.content;_.length>=31&&(_=_.substring(0,31));let c=r.addWorksheet(_);c.columns=s.columns.map(function(k){return{header:k,width:25}});let h;for(let k=0;k<u.length;k++){h=c.getRow(k+2);for(let m=0;m<u[k].length;m++)h.getCell(m+1).value=u[k][m]}c.getRow(1).font={bold:!0}}r.xlsx.writeBuffer({base64:!0}).then(function(s){var u=document.createElement("a"),f=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),_=URL.createObjectURL(f);u.href=_,u.download="flow.xlsx",document.body.appendChild(u),u.click(),setTimeout(function(){document.body.removeChild(u),window.URL.revokeObjectURL(_)},0)}).catch(function(s){console.log(s.message)}),o()}return t.$$set=r=>{"closePopup"in r&&n(3,o=r.closePopup)},[l,i,a,o]}class In extends ne{constructor(e){super();le(this,e,Vn,En,x,{closePopup:3})}}function Kn(t){let e,n,l,o,i;return n=new ie({props:{icon:"upload",text:"choose file from computer",tooltip:"upload a JSON file from your computer",tooltipLayout:"top"}}),n.$on("click",zn),{c(){e=P("div"),O(n.$$.fragment),l=I(),o=P("p"),o.textContent="Or drag and drop a JSON file anywhere in this window",F(o,"class","svelte-1vv9x21"),F(e,"class","top svelte-1vv9x21")},m(a,r){N(a,e,r),U(n,e,null),D(e,l),D(e,o),i=!0},p:fe,i(a){i||(A(n.$$.fragment,a),i=!0)},o(a){B(n.$$.fragment,a),i=!1},d(a){a&&j(e),E(n)}}}function zn(){document.getElementById("uploadId").click()}class Xn extends ne{constructor(e){super();le(this,e,null,Kn,x,{})}}function Wn(t){let e;return{c(){e=ke("no name")},m(n,l){N(n,e,l)},p:fe,d(n){n&&j(e)}}}function Jn(t){let e=t[0].content+"",n;return{c(){n=ke(e)},m(l,o){N(l,n,o)},p(l,o){o&1&&e!==(e=l[0].content+"")&&Le(n,e)},d(l){l&&j(n)}}}function Yn(t){let e,n,l,o,i;function a(u,f){return u[0].content?Jn:Wn}let r=a(t),s=r(t);return{c(){e=P("div"),n=P("button"),s.c(),F(n,"class","svelte-36g0jx"),H(n,"selected",t[1]),H(n,"empty",t[0].content.length==0),F(e,"class","top svelte-36g0jx"),H(e,"invert",t[0].invert)},m(u,f){N(u,e,f),D(e,n),s.m(n,null),o||(i=X(n,"click",t[2]),o=!0)},p(u,[f]){r===(r=a(u))&&s?s.p(u,f):(s.d(1),s=r(u),s&&(s.c(),s.m(n,null))),f&2&&H(n,"selected",u[1]),f&1&&H(n,"empty",u[0].content.length==0),f&1&&H(e,"invert",u[0].invert)},i(u){l||he(()=>{l=Fe(e,fn,{}),l.start()})},o:fe,d(u){u&&j(e),s.d(),o=!1,i()}}}function Gn(t,e,n){let{flow:l}=e,{selected:o}=e;function i(a){ce.call(this,t,a)}return t.$$set=a=>{"flow"in a&&n(0,l=a.flow),"selected"in a&&n(1,o=a.selected)},[l,o,i]}class Qn extends ne{constructor(e){super();le(this,e,Gn,Yn,x,{flow:0,selected:1})}}const{document:je}=Zt;function ht(t,e,n){const l=t.slice();return l[30]=e[n],l[31]=e,l[32]=n,l}function _t(t,e,n){const l=t.slice();return l[33]=e[n],l[32]=n,l}function pt(t){let e,n,l,o,i,a,r=t[0],s=[];for(let f=0;f<r.length;f+=1)s[f]=gt(_t(t,r,f));const u=f=>B(s[f],1,1,()=>{s[f]=null});return{c(){e=P("div"),n=P("div");for(let f=0;f<s.length;f+=1)s[f].c();F(n,"class","popups svelte-19g7rpn"),F(e,"class","screen svelte-19g7rpn")},m(f,_){N(f,e,_),D(e,n);for(let c=0;c<s.length;c+=1)s[c].m(n,null);o=!0,i||(a=[X(n,"click",Ze(t[12])),X(e,"click",Ze(t[13]))],i=!0)},p(f,_){if(t=f,_[0]&513){r=t[0];let c;for(c=0;c<r.length;c+=1){const h=_t(t,r,c);s[c]?(s[c].p(h,_),A(s[c],1)):(s[c]=gt(h),s[c].c(),A(s[c],1),s[c].m(n,null))}for(re(),c=r.length;c<s.length;c+=1)u(c);ue()}},i(f){if(!o){for(let _=0;_<r.length;_+=1)A(s[_]);he(()=>{l||(l=ve(e,$e,{duration:ae},!0)),l.run(1)}),o=!0}},o(f){s=s.filter(Boolean);for(let _=0;_<s.length;_+=1)B(s[_]);l||(l=ve(e,$e,{duration:ae},!1)),l.run(0),o=!1},d(f){f&&j(e),Re(s,f),f&&l&&l.end(),i=!1,_e(a)}}}function gt(t){let e,n;function l(){return t[11](t[32])}return e=new Un({props:{component:t[33],closeSelf:l}}),{c(){O(e.$$.fragment)},m(o,i){U(e,o,i),n=!0},p(o,i){t=o;const a={};i[0]&1&&(a.component=t[33]),e.$set(a)},i(o){n||(A(e.$$.fragment,o),n=!0)},o(o){B(e.$$.fragment,o),n=!1},d(o){E(e,o)}}}function Zn(t){let e,n,l,o;return e=new ie({props:{icon:"download",disabled:t[1].length==0,disabledReason:"nothing to download",tooltip:"download as file"}}),e.$on("click",t[14]),l=new ie({props:{icon:"upload",tooltip:"import file"}}),l.$on("click",t[15]),{c(){O(e.$$.fragment),n=I(),O(l.$$.fragment)},m(i,a){U(e,i,a),N(i,n,a),U(l,i,a),o=!0},p(i,a){const r={};a[0]&2&&(r.disabled=i[1].length==0),e.$set(r)},i(i){o||(A(e.$$.fragment,i),A(l.$$.fragment,i),o=!0)},o(i){B(e.$$.fragment,i),B(l.$$.fragment,i),o=!1},d(i){E(e,i),i&&j(n),E(l,i)}}}function mt(t){let e,n,l;function o(r){t[16](r,t[32])}function i(){return t[17](t[32])}let a={selected:t[32]==t[2]};return t[1][t[32]]!==void 0&&(a.flow=t[1][t[32]]),e=new Qn({props:a}),W.push(()=>G(e,"flow",o)),e.$on("click",i),{c(){O(e.$$.fragment)},m(r,s){U(e,r,s),l=!0},p(r,s){t=r;const u={};s[0]&4&&(u.selected=t[32]==t[2]),!n&&s[0]&2&&(n=!0,u.flow=t[1][t[32]],Q(()=>n=!1)),e.$set(u)},i(r){l||(A(e.$$.fragment,r),l=!0)},o(r){B(e.$$.fragment,r),l=!1},d(r){E(e,r)}}}function bt(t){let e,n,l,o,i,a,r,s,u,f,_,c,h,k=t[2],m,p;function S(d){t[20](d)}function y(d){t[21](d)}function V(d){t[22](d)}function J(d){t[23](d)}function C(d){t[24](d)}function z(d){t[25](d)}let L={};t[1][t[2]].content!==void 0&&(L.content=t[1][t[2]].content),t[1][t[2]].children!==void 0&&(L.children=t[1][t[2]].children),t[1][t[2]].index!==void 0&&(L.index=t[1][t[2]].index),t[1][t[2]].level!==void 0&&(L.level=t[1][t[2]].level),t[1][t[2]].focus!==void 0&&(L.focus=t[1][t[2]].focus),t[1][t[2]].invert!==void 0&&(L.invert=t[1][t[2]].invert),n=new Ln({props:L}),W.push(()=>G(n,"content",S)),W.push(()=>G(n,"children",y)),W.push(()=>G(n,"index",V)),W.push(()=>G(n,"level",J)),W.push(()=>G(n,"focus",C)),W.push(()=>G(n,"invert",z));function ee(d){t[26](d)}let T={};t[1][t[2]]!==void 0&&(T.flow=t[1][t[2]]),_=new Tn({props:T}),W.push(()=>G(_,"flow",ee));let b=vt(t);return{c(){e=P("div"),O(n.$$.fragment),u=I(),f=P("div"),O(_.$$.fragment),h=I(),b.c(),m=Pe(),F(e,"class","title svelte-19g7rpn"),F(f,"class","box-control svelte-19g7rpn")},m(d,M){N(d,e,M),U(n,e,null),N(d,u,M),N(d,f,M),U(_,f,null),N(d,h,M),b.m(d,M),N(d,m,M),p=!0},p(d,M){const q={};!l&&M[0]&6&&(l=!0,q.content=d[1][d[2]].content,Q(()=>l=!1)),!o&&M[0]&6&&(o=!0,q.children=d[1][d[2]].children,Q(()=>o=!1)),!i&&M[0]&6&&(i=!0,q.index=d[1][d[2]].index,Q(()=>i=!1)),!a&&M[0]&6&&(a=!0,q.level=d[1][d[2]].level,Q(()=>a=!1)),!r&&M[0]&6&&(r=!0,q.focus=d[1][d[2]].focus,Q(()=>r=!1)),!s&&M[0]&6&&(s=!0,q.invert=d[1][d[2]].invert,Q(()=>s=!1)),n.$set(q);const g={};!c&&M[0]&6&&(c=!0,g.flow=d[1][d[2]],Q(()=>c=!1)),_.$set(g),M[0]&4&&x(k,k=d[2])?(re(),B(b,1,1,fe),ue(),b=vt(d),b.c(),A(b),b.m(m.parentNode,m)):b.p(d,M)},i(d){p||(A(n.$$.fragment,d),A(_.$$.fragment,d),A(b),p=!0)},o(d){B(n.$$.fragment,d),B(_.$$.fragment,d),B(b),p=!1},d(d){d&&j(e),E(n),d&&j(u),d&&j(f),E(_),d&&j(h),d&&j(m),b.d(d)}}}function vt(t){let e,n,l,o;function i(r){t[27](r)}let a={};return t[1][t[2]]!==void 0&&(a.root=t[1][t[2]]),n=new yn({props:a}),W.push(()=>G(n,"root",i)),n.$on("focusFlow",t[4]),{c(){e=P("div"),O(n.$$.fragment),F(e,"class","flow svelte-19g7rpn")},m(r,s){N(r,e,s),U(n,e,null),o=!0},p(r,s){const u={};!l&&s[0]&6&&(l=!0,u.root=r[1][r[2]],Q(()=>l=!1)),n.$set(u)},i(r){o||(A(n.$$.fragment,r),o=!0)},o(r){B(n.$$.fragment,r),o=!1},d(r){r&&j(e),E(n)}}}function $n(t){let e,n,l,o,i,a,r,s,u,f,_,c,h,k,m,p,S,y,V,J,C=t[0].length>0&&pt(t);s=new Lt({props:{$$slots:{default:[Zn]},$$scope:{ctx:t}}});let z=t[1],L=[];for(let b=0;b<z.length;b+=1)L[b]=mt(ht(t,z,b));const ee=b=>B(L[b],1,1,()=>{L[b]=null});k=new ie({props:{text:"on case",icon:"add",tooltip:"create new oncase flow"}}),k.$on("click",t[18]),p=new ie({props:{text:"off case",icon:"add",tooltip:"create new offcase flow"}}),p.$on("click",t[19]);let T=t[1].length>0&&bt(t);return{c(){e=I(),C&&C.c(),n=I(),l=P("input"),o=I(),i=P("main"),a=P("div"),r=P("div"),O(s.$$.fragment),u=I(),f=P("div"),_=P("ul");for(let b=0;b<L.length;b+=1)L[b].c();c=I(),h=P("div"),O(k.$$.fragment),m=I(),O(p.$$.fragment),S=I(),T&&T.c(),F(l,"id","uploadId"),F(l,"type","file"),l.hidden=!0,F(r,"class","header svelte-19g7rpn"),F(h,"class","add-tab svelte-19g7rpn"),F(_,"class","svelte-19g7rpn"),F(f,"class","tabs svelte-19g7rpn"),F(a,"class","sidebar svelte-19g7rpn"),F(i,"style",`--transition-speed: ${ae}ms;`),F(i,"class","svelte-19g7rpn")},m(b,d){N(b,e,d),C&&C.m(b,d),N(b,n,d),N(b,l,d),N(b,o,d),N(b,i,d),D(i,a),D(a,r),U(s,r,null),D(a,u),D(a,f),D(f,_);for(let M=0;M<L.length;M+=1)L[M].m(_,null);D(_,c),D(_,h),U(k,h,null),D(h,m),U(p,h,null),D(i,S),T&&T.m(i,null),y=!0,V||(J=[X(je.body,"keydown",t[6]),X(je.body,"dragenter",xn),X(je.body,"drop",t[7]),X(l,"change",t[8])],V=!0)},p(b,d){b[0].length>0?C?(C.p(b,d),d[0]&1&&A(C,1)):(C=pt(b),C.c(),A(C,1),C.m(n.parentNode,n)):C&&(re(),B(C,1,1,()=>{C=null}),ue());const M={};if(d[0]&2|d[1]&16&&(M.$$scope={dirty:d,ctx:b}),s.$set(M),d[0]&14){z=b[1];let q;for(q=0;q<z.length;q+=1){const g=ht(b,z,q);L[q]?(L[q].p(g,d),A(L[q],1)):(L[q]=mt(g),L[q].c(),A(L[q],1),L[q].m(_,c))}for(re(),q=z.length;q<L.length;q+=1)ee(q);ue()}b[1].length>0?T?(T.p(b,d),d[0]&2&&A(T,1)):(T=bt(b),T.c(),A(T,1),T.m(i,null)):T&&(re(),B(T,1,1,()=>{T=null}),ue())},i(b){if(!y){A(C),A(s.$$.fragment,b);for(let d=0;d<z.length;d+=1)A(L[d]);A(k.$$.fragment,b),A(p.$$.fragment,b),A(T),y=!0}},o(b){B(C),B(s.$$.fragment,b),L=L.filter(Boolean);for(let d=0;d<L.length;d+=1)B(L[d]);B(k.$$.fragment,b),B(p.$$.fragment,b),B(T),y=!1},d(b){b&&j(e),C&&C.d(b),b&&j(n),b&&j(l),b&&j(o),b&&j(i),E(s),Re(L,b),E(k),E(p),T&&T.d(),V=!1,_e(J)}}}function xn(t){t.preventDefault()}function el(t,e,n){let l,o;de(t,Z,w=>n(1,l=w)),de(t,be,w=>n(2,o=w));function i(w){Ae(be,o=w,o),a()}function a(){var Y,$;let w=((Y=l[o])==null?void 0:Y.lastFocus)&&se(($=l[o])==null?void 0:$.lastFocus);w?w.focus=!0:Ae(Z,l[o].children[0].focus=!0,l),Z.set(l)}function r(){var Y,$;let w=((Y=l[o])==null?void 0:Y.lastFocus)&&se(($=l[o])==null?void 0:$.lastFocus);w&&(w.focus=!1)}function s(w){r(),l.push(on(l.length,w)),Ae(be,o=l.length-1,o),Z.set(l)}function u(w){w.ctrlKey&&w.shiftKey&&w.key=="N"?(w.preventDefault(),s("aff")):w.ctrlKey&&w.key=="n"&&(w.preventDefault(),s("neg")),w.metaKey&&w.shiftKey&&w.key=="z"?(w.preventDefault(),l[o].history.redo()):w.metaKey&&w.key=="z"&&(w.preventDefault(),l[o].history.undo())}function f(w){w.preventDefault();let Y=w.dataTransfer.files[0],$=new FileReader;$.onload=function(De){c(De.target.result)},$.readAsText(Y,"UTF-8")}function _(){let w=document.getElementById("uploadId").files[0],Y=new FileReader;Y.onload=function($){c($.target.result)},Y.readAsText(w,"UTF-8")}function c(w){let Y=JSON.parse(w);Ae(Z,l=[],l);for(let $ of Y)$.history=new Ft,l.push($)}window.addEventListener("dragover",function(w){w.preventDefault()},!1),window.addEventListener("drop",function(w){w.preventDefault()},!1);let h=[];function k(w){h.splice(w,1),n(0,h)}function m(w){h.push(w),n(0,h)}const p=w=>k(w),S=()=>{h.length==1&&k(0)},y=()=>{h.length==1&&k(0)},V=()=>m(In),J=()=>m(Xn);function C(w,Y){t.$$.not_equal(l[Y],w)&&(l[Y]=w,Z.set(l))}const z=w=>i(w),L=()=>s("aff"),ee=()=>s("neg");function T(w){t.$$.not_equal(l[o].content,w)&&(l[o].content=w,Z.set(l))}function b(w){t.$$.not_equal(l[o].children,w)&&(l[o].children=w,Z.set(l))}function d(w){t.$$.not_equal(l[o].index,w)&&(l[o].index=w,Z.set(l))}function M(w){t.$$.not_equal(l[o].level,w)&&(l[o].level=w,Z.set(l))}function q(w){t.$$.not_equal(l[o].focus,w)&&(l[o].focus=w,Z.set(l))}function g(w){t.$$.not_equal(l[o].invert,w)&&(l[o].invert=w,Z.set(l))}function R(w){t.$$.not_equal(l[o],w)&&(l[o]=w,Z.set(l))}function oe(w){t.$$.not_equal(l[o],w)&&(l[o]=w,Z.set(l))}return window.document.body.classList.add("dark"),[h,l,o,i,a,s,u,f,_,k,m,p,S,y,V,J,C,z,L,ee,T,b,d,M,q,g,R,oe]}class tl extends ne{constructor(e){super();le(this,e,el,$n,x,{},null,[-1,-1])}}new tl({target:document.body});
